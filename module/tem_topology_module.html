<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Tree based Elemental Mesh">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>tem_topology_module &ndash; Treelm</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Treelm </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">TreElm Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tem_topology_module
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-author"><i class="fa fa-pencil"></i> Harald Klimach</li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.5% of total for modules and submodules.">187 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tem_topology_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tem_topology_module.f90.html'>tem_topology_module.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">tem_topology_module</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tem_topology_module.html#variable-firstidatlevel">firstIdAtLevel</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#inters-0"
         aria-expanded="false" aria-controls="inters-0">
         <h4 class="card-header bg-primary text-white">Interfaces</h4>
      </a>
      <div id="inters-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tem_topology_module.html#interface-tem_parentof">tem_ParentOf</a>
        </div>
      </div>
    </div>

  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tem_topology_module.html#type-tem_path_type">tem_path_type</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_levelof">tem_LevelOf</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_firstidatlevel">tem_FirstIdAtLevel</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_lastidatlevel">tem_LastIdAtLevel</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_siblingsofid">tem_SiblingsOfId</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_childnumber">tem_childNumber</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_pathof">tem_PathOf</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_directchildren">tem_directChildren</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_treeidcomparison">tem_TreeIDComparison</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_pathcomparison">tem_PathComparison</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_coordofid">tem_CoordOfId</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_idofcoord">tem_IdOfCoord</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_directparent">tem_directParent</a>
            <a class="list-group-item" href="../module/tem_topology_module.html#proc-tem_parentatlevel">tem_ParentAtLevel</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>This module provides informations and operations on
the topology of the complete linearized octree.
It is completely independent of the actual sparse
octree and therefore this module is independent of the Treelmesh_module.</p>
<h2 id="node-identification-in-the-octree">Node identification in the octree</h2>
<p>Due to the breadth first numbering of the octree
it is straight forward to move in vertical direction through the tree.</p>
<p>The parent <script type="math/tex">i_p</script> of a node with a certain
<a href="../type/treelmesh_type.html#variable-treeid~3">treeID</a> <script type="math/tex">i_n</script> is given by:
<script type="math/tex; mode=display">  i_p = \left\lfloor \frac{i_n - 1}{8} \right\rfloor </script>
Where the bracket <script type="math/tex">\left\lfloor\cdot\right\rfloor</script> denotes the integer floor
rounding to the next smaller integer number.
While the children <script type="math/tex">i_{c1..8}</script> of a given node <script type="math/tex">i_n</script> can be obtained by:
<script type="math/tex; mode=display">   i_{cj} = 8 \cdot i_n + j </script>
The numbering scheme begins at the root node with a
<a href="../type/treelmesh_type.html#variable-treeid~3">treeID</a> of 0 for
this element, that covers the complete enclosed cubic domain.
All further <a href="../type/treelmesh_type.html#variable-treeid~3">treeID</a>s are then
given by the rules stated above.
What remains to be defined is the actual spatial placement of the nodes in
the tree as elements in the mesh.
This is achieved by a space filling curve, that describes the numbering
scheme of the 8 children for a given node.</p>
<p>Our choice here is the Morton ordering [6] (bibliography of treelm) , that
allows an efficient computation of the index from the coordinates with the
same orientation on each refinement level.
For this ordering the coordinates of the children within their parent element
are first noted as a three dimensional tuple, where each index might be 0 or
1.
Now this tuple is interpreted as a single number of the basis 2 with three
digits.
The recursive in depth traversal results then in a concatenation of these
numbers visited during the traversal.
This concatenated number provides the sorting key for all elements on a given
level according to the space filling curve.</p>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='env_module.html'>env_module</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-firstidatlevel"></span>
              integer(kind=long_k),
            </td>
              <td>public,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>firstIdAtLevel</strong>(20)</td>
<td> =</td>
                <td>[1_long_k, 9_long_k, 73_long_k, 585_long_k, 4681_long_k, 37449_long_k, 299593_long_k, 2396745_long_k, 19173961_long_k, 153391689_long_k, 1227133513_long_k, 9817068105_long_k, 78536544841_long_k, 628292358729_long_k, 5026338869833_long_k, 40210710958665_long_k, 321685687669321_long_k, 2573485501354569_long_k, 20587884010836553_long_k, 164703072086692425_long_k]</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>


        <section>
          <h2>Interfaces</h2>
              <div class="card">
    <div class="card-header bg-light codesum">
      <span class="anchor" id="interface-tem_parentof"></span>
      <h3>public        interface <a href='../interface/tem_parentof.html'>tem_ParentOf</a> 
      </h3>
    </div>
    <ul class="list-group">
          <li class="list-group-item">
                <h3>
    private elemental function <a href='../proc/tem_directparent.html'>tem_directParent</a>(TreeID) result(res)  

    </h3>
    
  <p>This function delivers the parent ID of a given TreeID</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~5"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>current treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>result of function containing parent ID</p>

          </li>
          <li class="list-group-item">
                <h3>
    private  function <a href='../proc/tem_parentatlevel.html'>tem_ParentAtLevel</a>(TreeID, level) result(parentID)  

    </h3>
    
  <p>This function provides the parent ID of a given tree ID on a given level.</p>
<p>The parent ID on a given level is calculated using the equation
\f[
   id_{l-1}=\frac{id_{l}-1}{8}
\f]
in a loop.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~7"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>treeID of which the pID is requested</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-level~13"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>level</strong></td>
            <td>
<p>the level on which the pID is requested</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>resulting parent ID</p>

          </li>
    </ul>
  </div>

        </section>
        <br>


        <section>
          <h2>Derived Types</h2>
              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-tem_path_type"></span>
      <h3>
        type, public&nbsp;::&nbsp;
        <a href='../type/tem_path_type.html'>tem_path_type</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Paths of elements from the root node to themselves going through the
hierarchy of the tree. Is used to compare to elements</p><a href="../type/tem_path_type.html" class="pull-right"><emph>Read more&hellip;</emph></a>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-level"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>Level</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Levels counted from 1
This level is 1 higher than the actual level.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node"></span>
              integer(kind=long_k),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>Node</strong>(globalMaxLevels+1)</td>
                <td></td>
                <td></td>
            <td>
<p>treeIDs from current leaf to root</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Functions</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_levelof"></span> <h3>public elemental function <a href='../proc/tem_levelof.html'>tem_LevelOf</a>(TreeID) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function delivers the refinement level of a TreeID</p><a href="../proc/tem_levelof.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~2"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>ID in the complete tree to look up</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer</small>
    </h4>
    <p>Level of the given TreeID</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_firstidatlevel"></span> <h3>public elemental function <a href='../proc/tem_firstidatlevel.html'>tem_FirstIdAtLevel</a>(level) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function delivers the refinement level of a TreeID</p><a href="../proc/tem_firstidatlevel.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-level~11"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>level</strong></td>
            <td>
<p>level to check</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>resulting first treeID</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_lastidatlevel"></span> <h3>public elemental function <a href='../proc/tem_lastidatlevel.html'>tem_LastIdAtLevel</a>(level) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>Last ID in the complete tree on a given level</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-level~12"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>level</strong></td>
            <td>
<p>level to check</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>resulting last treeID</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_siblingsofid"></span> <h3>public  function <a href='../proc/tem_siblingsofid.html'>tem_SiblingsOfId</a>(TreeID) result(siblings)  
</h3></div>
    <div class="card-body">
          
  <p>This function delivers all sibling treeIDs of TreeID in an array</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~3"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>current treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k), (7)</small>
    </h4>
    <p>treeIDs siblings</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_childnumber"></span> <h3>public elemental function <a href='../proc/tem_childnumber.html'>tem_childNumber</a>(TreeID) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function delivers of TreeID, which child number it is from its parent</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~4"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>current treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer</small>
    </h4>
    <p>result of function containing child number</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_pathof"></span> <h3>public elemental function <a href='../proc/tem_pathof.html'>tem_PathOf</a>(TreeID) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function returns the complete path through the tree from
a given treeID to the root (all parents).</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~6"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>current treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>type(<a href='../type/tem_path_type.html'>tem_path_type</a>)</small>
    </h4>
    <p>resulting path</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_directchildren"></span> <h3>public  function <a href='../proc/tem_directchildren.html'>tem_directChildren</a>(TreeID) result(childrenIDs)  
</h3></div>
    <div class="card-body">
          
  <p>This function delivers the direct children in the full tree for
a given tree ID</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~8"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>given treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k), (8)</small>
    </h4>
    <p>Array for the treeIDs of the 8 direct children</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_treeidcomparison"></span> <h3>public elemental function <a href='../proc/tem_treeidcomparison.html'>tem_TreeIDComparison</a>(left, right) result(relation)  
</h3></div>
    <div class="card-body">
          
  <p>Compare Position of two treeIDs in the linearized tree
This is relatively expansive, therefore the result should
be stored, if more than one comparison of the same treeIDs
has to be done.
Result:
-1: left is lower  than right
 0: left is same   than right
 1: left is higher than right</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-left~13"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>left</strong></td>
            <td>
<p>candidate treeID</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-right~13"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>right</strong></td>
            <td>
<p>candidate treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer</small>
    </h4>
    <p>relation between the treeIDs</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_pathcomparison"></span> <h3>public elemental function <a href='../proc/tem_pathcomparison.html'>tem_PathComparison</a>(left, right) result(relation)  
</h3></div>
    <div class="card-body">
          
  <p>Compare two Paths in the linearized tree
Result:
-1: left is lower  than right
 0: left is same   than right
 1: left is higher than right</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-left~14"></span>
              type(<a href='../type/tem_path_type.html'>tem_path_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>left</strong></td>
            <td>
<p>candidate path</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-right~14"></span>
              type(<a href='../type/tem_path_type.html'>tem_path_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>right</strong></td>
            <td>
<p>candidate path</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer</small>
    </h4>
    <p>relation between the paths</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_coordofid"></span> <h3>public pure function <a href='../proc/tem_coordofid.html'>tem_CoordOfId</a>(TreeID, offset) result(coord)  
</h3></div>
    <div class="card-body">
          
  <p>The following function provides the spatial index triple for a given ID in
the complete mesh, on its refinement level.
The returned coordinates start at 0.
The fourth entry is the level on which the coordinates are located in the
tree.
The steps are following:
1. calculate the refinement level, store to coord(4).
2. Calcualte the level offset.
3. the Morton index is obtained by subtracting the offset from treeID.
4. Apply bit interleaving rule to generate coordinates.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~9"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>input element ID</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-offset~14"></span>
              integer(kind=long_k),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>offset</strong></td>
            <td>
<p>First Elem of current level, if known, to avoid recomputations</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer, (4)</small>
    </h4>
    <p>coordinate of element return value</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_idofcoord"></span> <h3>public pure function <a href='../proc/tem_idofcoord.html'>tem_IdOfCoord</a>(coord, offset) result(nTreeID)  
</h3></div>
    <div class="card-body">
          
  <p>This function calculates the tree ID for a given x,y and z on the given
refinement level. This ID in the complete tree does not have to be in the
list of leafs (treeIDlist)
An example of this procedure is following:
1. Convert coordinates into binary representation:
  (x,y,z) = (5,9,1) = (0101,1001,0001)
2. Interleaving the bits by 3 digits for each direction:
       x(0101):   <strong>0 </strong>1 <strong>0 </strong>1
       y(1001):   <em>1</em> <em>0</em> <em>0</em> <em>1</em>
       z(0001):   0<strong> 0</strong> 0<strong> 1</strong>
   Combining these bits results in a binary number: 010 001 000 111,
   which is 1095 when seen as a 10-base number.
3. This number is the cell position in a single level sorted element list.
   Its treeID can be obtained by adding the correspoding level offset.</p><a href="../proc/tem_idofcoord.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-coord~82"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>coord</strong>(4)</td>
            <td>
<p>3D Coordinates to translate</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-offset~15"></span>
              integer(kind=long_k),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>offset</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>resulting treeID</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_directparent"></span> <h3>private elemental function <a href='../proc/tem_directparent.html'>tem_directParent</a>(TreeID) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function delivers the parent ID of a given TreeID</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~5"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>current treeID</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>result of function containing parent ID</p>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_parentatlevel"></span> <h3>private  function <a href='../proc/tem_parentatlevel.html'>tem_ParentAtLevel</a>(TreeID, level) result(parentID)  
</h3></div>
    <div class="card-body">
          
  <p>This function provides the parent ID of a given tree ID on a given level.</p><a href="../proc/tem_parentatlevel.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-treeid~7"></span>
              integer(kind=long_k),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>TreeID</strong></td>
            <td>
<p>treeID of which the pID is requested</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-level~13"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>level</strong></td>
            <td>
<p>the level on which the pID is requested</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>integer(kind=long_k)</small>
    </h4>
    <p>resulting parent ID</p>

    </div>
  </div>

        </section>
        <br>




    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Treelm
 was developed by University of Siegen<br>              &copy; 2025 
<br /><small>9899d1376992</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-02T13:06:23.655310+0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>