<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Tree based Elemental Mesh">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>tem_bc_module &ndash; Treelm</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Treelm </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">TreElm Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tem_bc_module
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.2% of total for modules and submodules.">90 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tem_bc_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tem_bc_module.f90.html'>tem_bc_module.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">tem_bc_module</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tem_bc_module.html#type-tem_bc_state_type">tem_bc_state_type</a>
        </div>
      </div>
    </div>

  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tem_bc_module.html#proc-tem_load_bc_state">tem_load_bc_state</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>Definition of the boundary property for elements</p>
<p>The has-boundary <a href="../module/tem_property_module.html">tem_property_module</a> highlights an element
that has at least one side with a boundary condition.
Therefore the neighbor on this side is not part of the computational domain,
and needs to be treated accordingly.
For all elements with the has-boundary property, the boundary conditions are
stored for all sides.
Yet this is done in a elementwise manner to allow arbitrary distribution of
the elments to parallel processing units. The appropiate handling of the
boundaries is solver specific and left to them.</p>
<p>Each boundary is identified by a unique number (ID), which starts from 1 and
ranges up to the number of existing boundaries (nBCtypes).
In the solvers, the labels of the boundaries attached to the boundary IDs in
the array of strings <em>BC_label</em> are analyzed in order to treat the
boundaries adequately.</p>
<p>For each element with the has-boundary property, a boundary ID is assigned
for each of the 26 direct neighbor directions.
This is done in the two-dimensional array <em>boundary_ID</em>,
where the first dimension has nSides entries and the second dimension has as
many entries as there elements with the has-boundary property on the local
partition.
For regular fluid neighbors, the boundary ID is set to zero in the respective
direction.</p>
<p><img alt="boundary data structure" src="../media/boundary_data_structure.png"></p>
<p>To attach boundary conditions a bit is set for an element to indicate that
any of its sides has a boundary condition attached to it.
For all elements with this property and only those elements, boundary
conditions on every side of the element are stored.
This data is put in a separate file, containing the boundary conditions per
side for all elements with the boundary property.
The binary file has the same number of integer entries for all elements and
can therefore be easily accessed on an elemental basis.
In this list of elements the ordering from the complete mesh is preserved.
To describe the meaning of each boundary condition, indicated by an integer
number, there is an additional header file with labels for each type of
boundary condition in the mesh.
Only positive integers are considered as boundary entries, zeros indicate no
boundary in the corresponding direction, and negative numbers are reserved
for references on <em>treeIDs</em> as neighboring element.
Directly referencing a certain <em>treeID</em> instead of a boundary condition
on one of the sides of an element is used to implement periodic interfaces
within the universe cube.
Due to this layout of the boundary description, the boundaries can be read in
parallel with the following procedure:</p>
<ul>
<li>Count the local number of elements with boundary conditions (given by the
  property bits defined for all elements).</li>
<li>Build a prefix summation across all partitions to find the offset of the
  local set of boundary conditions in the sparse set of global boundary
  conditions.</li>
<li>Read this set of elemental boundary conditions from the file accordingly
  from the offset up to the number of local elements with boundary
  conditions.</li>
</ul>
<p>With the strict ordering and uniform elemental treatment of data, the sparse
property information can be accessed efficiently.
Just a single collective prefix operation is required in the parallel system,
while the consumed disk storage is kept at a minimum.</p>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='env_module.html'>env_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aot_table_module.html'>aot_table_module</a></li>
                  <li class="list-inline-item"><a href='tem_varmap_module.html'>tem_varMap_module</a></li>
                  <li class="list-inline-item"><a href='tem_operation_module.html'>tem_operation_module</a></li>
                  <li class="list-inline-item"><a href='tem_logging_module.html'>tem_logging_module</a></li>
                  <li class="list-inline-item"><a href='tem_spacetime_fun_module.html'>tem_spacetime_fun_module</a></li>
                  <li class="list-inline-item"><a href='tem_varsys_module.html'>tem_varSys_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aotus_module.html'>aotus_module</a></li>
                  <li class="list-inline-item"><a href='tem_stringkeyvaluepair_module.html'>tem_stringKeyValuePair_module</a></li>
                  <li class="list-inline-item"><a href='tem_aux_module.html'>tem_aux_module</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>






        <section>
          <h2>Derived Types</h2>
              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-tem_bc_state_type"></span>
      <h3>
        type, public&nbsp;::&nbsp;
        <a href='../type/tem_bc_state_type.html'>tem_bc_state_type</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>boundary state type definition for boundary state variable</p><a href="../type/tem_bc_state_type.html" class="pull-right"><emph>Read more&hellip;</emph></a>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-state_name"></span>
              character(len=LabelLen),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>state_name</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Name of the state, this boundary condition applies to</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-style"></span>
              character(len=LabelLen),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>style</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Style of this boundary condition
dirichlet = set value itself
neumann = set derivative of value</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncomponents~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nComponents</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Number of Components in this boundary variable.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isdefined~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isDefined</strong></td>
                <td></td>
                <td></td>
            <td>
<p>A flag to indicate that the state is properly defined</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-varpos~9"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>varPos</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Position of variable defined for the state_name in the varSys</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pntindex"></span>
              type(<a href='../type/tem_indexlvl_type.html'>tem_indexLvl_type</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>pntIndex</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Indices for points on the boundary, required for setup_index,
getvalof_Index</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

        </section>
        <br>


        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-tem_load_bc_state"></span> <h3>public  subroutine <a href='../proc/tem_load_bc_state.html'>tem_load_bc_state</a>(bc, state_name, nComp, style, conf, bc_handle, varDict, varSys, solverData_evalElem, ErrCode)  
</h3></div>
    <div class="card-body">
          
  <p>Function to load spatial, constant or temporal boundary conditions to
 the boundary state type (or combinations of them).
 <script type="math/tex">res = f(x,y,z)*g(t)</script> or <script type="math/tex">res = f(x,y,z,t)</script>
 Valid definitions:
 Example given for state variable velocityX in variable table</p><a href="../proc/tem_load_bc_state.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bc"></span>
              type(<a href='../type/tem_bc_state_type.html'>tem_bc_state_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bc</strong></td>
            <td>
<p>The boundary to fill</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-state_name~2"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>state_name</strong></td>
            <td>
<p>The state variable to set with this boundary condition</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncomp~13"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nComp</strong></td>
            <td>
<p>Number of Components in this boundary variable.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-style~2"></span>
              character(len=*),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>style</strong></td>
            <td>
<p>Style of this boundary condition
dirichlet = set value itself
neumann = set derivative of value</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-conf~89"></span>
              type(<a href='https://apes-suite.github.io/aotus/type/flu_state.html'>flu_State</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>conf</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bc_handle"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bc_handle</strong></td>
            <td>
<p>Handle to the table describing the boundary</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vardict"></span>
              type(<a href='../type/grw_stringkeyvaluepairarray_type.html'>grw_stringkeyvaluepairarray_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>varDict</strong></td>
            <td>
<p>The dictionary that contains the mapping between expected variables
and the actual variables defined by the user.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-varsys~76"></span>
              type(<a href='../type/tem_varsys_type.html'>tem_varSys_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>varSys</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solverdata_evalelem~3"></span>
              type(<a href='../type/tem_varsys_solverdata_evalelem_type.html'>tem_varSys_solverData_evalElem_type</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solverData_evalElem</strong></td>
            <td>
<p>A routine that allows the construction of an element representation
from a point values.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-errcode"></span>
              integer,
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ErrCode</strong></td>
            <td>
<p>Error code</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>
        <br>



    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Treelm
 was developed by University of Siegen<br>              &copy; 2025 
<br /><small>9899d1376992</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-02T13:06:23.655310+0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>