<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Tree based Elemental Mesh">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>request_remoteHalos &ndash; Treelm</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Treelm </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">TreElm Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>request_remoteHalos
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.3% of total for procedures.">104 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tem_construction_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tem_construction_module.f90.html'>tem_construction_module.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/tem_construction_module.html'>tem_construction_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">request_remoteHalos</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/request_remotehalos.html#src">request_remoteHalos</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine request_remoteHalos(levelDesc, proc, tree, iLevel, stencil, pathFirst, pathLast)  
</h2>
    

    <p>Inverse Communication: Communicate, which elements each process needs from
me.</p>
<p>In this routine, we send the treeIDs of the halo elements to the
processes, where they are located. Later on, we fill these halos locally
with information from these processes (sourceProcs). In this routine
however, we now SEND information to these sourceProcs, so do not get
confused here.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-leveldesc~22"></span>
              type(<a href='../type/tem_leveldesc_type.html'>tem_levelDesc_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>levelDesc</strong>(tree%global%minlevel:)</td>
            <td>
                <p>the level descriptor to be filled</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-proc~11"></span>
              type(<a href='../type/tem_comm_env_type.html'>tem_comm_env_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>proc</strong></td>
            <td>
                <p>Process description to use.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tree~62"></span>
              type(<a href='../type/treelmesh_type.html'>treelmesh_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tree</strong></td>
            <td>
                <p>the global tree</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~34"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iLevel</strong></td>
            <td>
                <p>current level</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stencil~14"></span>
              type(<a href='../type/tem_stencilheader_type.html'>tem_stencilHeader_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>stencil</strong></td>
            <td>
                <p>stencil definition</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pathfirst~8"></span>
              type(<a href='../type/tem_path_type.html'>tem_path_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>pathFirst</strong>(:)</td>
            <td>
                <p>first and last treeID path in every process</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pathlast~8"></span>
              type(<a href='../type/tem_path_type.html'>tem_path_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>pathLast</strong>(:)</td>
            <td>
                <p>first and last treeID path in every process</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~request_remotehalos~~CallsGraph Pages: 1 -->
<svg id="procrequest_remotehalosCallsGraph" width="641pt" height="524pt"
 viewBox="0.00 0.00 641.00 524.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~request_remotehalos~~CallsGraph" class="graph" transform="scale(0.96 0.96) rotate(0) translate(4 545)">
<title>proc~~request_remotehalos~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-545 667,-545 667,4 -4,4"/>
<!-- proc~request_remotehalos -->
<g id="proc~~request_remotehalos~~CallsGraph_node1" class="node">
<title>proc~request_remotehalos</title>
<polygon fill="none" stroke="black" points="126,-254 0,-254 0,-230 126,-230 126,-254"/>
<text text-anchor="middle" x="63" y="-239.6" font-family="Helvetica,sans-Serif" font-size="10.50">request_remoteHalos</text>
</g>
<!-- interface~append~11 -->
<g id="proc~~request_remotehalos~~CallsGraph_node2" class="node">
<title>interface~append~11</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node2"><a xlink:href="../interface/append~11.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="443.5,-520 389.5,-520 389.5,-496 443.5,-496 443.5,-520"/>
<text text-anchor="middle" x="416.5" y="-505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;interface~append~11 -->
<g id="proc~~request_remotehalos~~CallsGraph_edge1" class="edge">
<title>proc~request_remotehalos&#45;&gt;interface~append~11</title>
<path fill="none" stroke="#000000" d="M65.97,-254.06C72.47,-289.86 96.69,-396.33 162,-449 225.64,-500.32 325.96,-508.57 379.31,-508.99"/>
<polygon fill="#000000" stroke="#000000" points="379.34,-512.49 389.33,-508.99 379.33,-505.49 379.34,-512.49"/>
</g>
<!-- interface~destroy~25 -->
<g id="proc~~request_remotehalos~~CallsGraph_node3" class="node">
<title>interface~destroy~25</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node3"><a xlink:href="../interface/destroy~25.html" xlink:title="destroy">
<polygon fill="#a7506f" stroke="#a7506f" points="265,-356 211,-356 211,-332 265,-332 265,-356"/>
<text text-anchor="middle" x="238" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">destroy</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;interface~destroy~25 -->
<g id="proc~~request_remotehalos~~CallsGraph_edge2" class="edge">
<title>proc~request_remotehalos&#45;&gt;interface~destroy~25</title>
<path fill="none" stroke="#000000" d="M75.19,-254.02C92.27,-271.66 126.6,-304.48 162,-323 174.01,-329.28 188.11,-333.86 200.82,-337.11"/>
<polygon fill="#000000" stroke="#000000" points="200.11,-340.54 210.65,-339.44 201.73,-333.73 200.11,-340.54"/>
</g>
<!-- interface~init~24 -->
<g id="proc~~request_remotehalos~~CallsGraph_node4" class="node">
<title>interface~init~24</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node4"><a xlink:href="../interface/init~24.html" xlink:title="init">
<polygon fill="#a7506f" stroke="#a7506f" points="265,-314 211,-314 211,-290 265,-290 265,-314"/>
<text text-anchor="middle" x="238" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;interface~init~24 -->
<g id="proc~~request_remotehalos~~CallsGraph_edge3" class="edge">
<title>proc~request_remotehalos&#45;&gt;interface~init~24</title>
<path fill="none" stroke="#000000" d="M98.92,-254.12C117.63,-260.61 141.07,-268.74 162,-276 174.84,-280.45 188.92,-285.34 201.38,-289.65"/>
<polygon fill="#000000" stroke="#000000" points="200.37,-293.01 210.97,-292.98 202.67,-286.39 200.37,-293.01"/>
</g>
<!-- interface~positionofval~5 -->
<g id="proc~~request_remotehalos~~CallsGraph_node5" class="node">
<title>interface~positionofval~5</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node5"><a xlink:href="../interface/positionofval~5.html" xlink:title="positionofval">
<polygon fill="#a7506f" stroke="#a7506f" points="457,-272 376,-272 376,-248 457,-248 457,-272"/>
<text text-anchor="middle" x="416.5" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">positionofval</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;interface~positionofval~5 -->
<g id="proc~~request_remotehalos~~CallsGraph_edge4" class="edge">
<title>proc~request_remotehalos&#45;&gt;interface~positionofval~5</title>
<path fill="none" stroke="#000000" d="M126.03,-245.18C194.36,-248.68 302.88,-254.23 365.83,-257.46"/>
<polygon fill="#000000" stroke="#000000" points="365.74,-260.96 375.91,-257.97 366.1,-253.97 365.74,-260.96"/>
</g>
<!-- mpi_irecv -->
<g id="proc~~request_remotehalos~~CallsGraph_node6" class="node">
<title>mpi_irecv</title>
<polygon fill="#777777" stroke="#777777" points="270,-192 206,-192 206,-168 270,-168 270,-192"/>
<text text-anchor="middle" x="238" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_irecv</text>
</g>
<!-- proc~request_remotehalos&#45;&gt;mpi_irecv -->
<g id="proc~~request_remotehalos~~CallsGraph_edge5" class="edge">
<title>proc~request_remotehalos&#45;&gt;mpi_irecv</title>
<path fill="none" stroke="#000000" d="M90.28,-229.97C109.82,-221.27 137.26,-209.6 162,-201 172.85,-197.23 184.77,-193.64 195.84,-190.54"/>
<polygon fill="#000000" stroke="#000000" points="197,-193.85 205.72,-187.84 195.15,-187.1 197,-193.85"/>
</g>
<!-- mpi_isend -->
<g id="proc~~request_remotehalos~~CallsGraph_node7" class="node">
<title>mpi_isend</title>
<polygon fill="#777777" stroke="#777777" points="271.5,-150 204.5,-150 204.5,-126 271.5,-126 271.5,-150"/>
<text text-anchor="middle" x="238" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_isend</text>
</g>
<!-- proc~request_remotehalos&#45;&gt;mpi_isend -->
<g id="proc~~request_remotehalos~~CallsGraph_edge6" class="edge">
<title>proc~request_remotehalos&#45;&gt;mpi_isend</title>
<path fill="none" stroke="#000000" d="M74.85,-229.97C91.74,-211.95 126.16,-178.02 162,-159 172.06,-153.66 183.62,-149.56 194.6,-146.47"/>
<polygon fill="#000000" stroke="#000000" points="195.67,-149.81 204.46,-143.9 193.9,-143.03 195.67,-149.81"/>
</g>
<!-- mpi_waitall -->
<g id="proc~~request_remotehalos~~CallsGraph_node8" class="node">
<title>mpi_waitall</title>
<polygon fill="#777777" stroke="#777777" points="274.5,-108 201.5,-108 201.5,-84 274.5,-84 274.5,-108"/>
<text text-anchor="middle" x="238" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_waitall</text>
</g>
<!-- proc~request_remotehalos&#45;&gt;mpi_waitall -->
<g id="proc~~request_remotehalos~~CallsGraph_edge7" class="edge">
<title>proc~request_remotehalos&#45;&gt;mpi_waitall</title>
<path fill="none" stroke="#000000" d="M70.02,-229.95C83.15,-204.94 116.84,-147.2 162,-117 170.86,-111.08 181.37,-106.81 191.68,-103.74"/>
<polygon fill="#000000" stroke="#000000" points="192.67,-107.1 201.44,-101.15 190.88,-100.33 192.67,-107.1"/>
</g>
<!-- proc~create_allparentneighbors -->
<g id="proc~~request_remotehalos~~CallsGraph_node9" class="node">
<title>proc~create_allparentneighbors</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node9"><a xlink:href="../proc/create_allparentneighbors.html" xlink:title="create_allParentNeighbors">
<polygon fill="#d9534f" stroke="#d9534f" points="314,-440 162,-440 162,-416 314,-416 314,-440"/>
<text text-anchor="middle" x="238" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">create_allParentNeighbors</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;proc~create_allparentneighbors -->
<g id="proc~~request_remotehalos~~CallsGraph_edge8" class="edge">
<title>proc~request_remotehalos&#45;&gt;proc~create_allparentneighbors</title>
<path fill="none" stroke="#000000" d="M68.4,-254.06C79.56,-283.07 111.73,-357.44 162,-399 168.13,-404.07 175.24,-408.31 182.6,-411.86"/>
<polygon fill="#000000" stroke="#000000" points="181.43,-415.16 191.99,-415.97 184.24,-408.75 181.43,-415.16"/>
</g>
<!-- proc~identify_halo -->
<g id="proc~~request_remotehalos~~CallsGraph_node10" class="node">
<title>proc~identify_halo</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node10"><a xlink:href="../proc/identify_halo.html" xlink:title="identify_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="278.5,-234 197.5,-234 197.5,-210 278.5,-210 278.5,-234"/>
<text text-anchor="middle" x="238" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">identify_halo</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;proc~identify_halo -->
<g id="proc~~request_remotehalos~~CallsGraph_edge9" class="edge">
<title>proc~request_remotehalos&#45;&gt;proc~identify_halo</title>
<path fill="none" stroke="#000000" d="M126.46,-234.78C146.38,-232.48 168.16,-229.96 187.07,-227.77"/>
<polygon fill="#000000" stroke="#000000" points="187.72,-231.22 197.26,-226.59 186.92,-224.27 187.72,-231.22"/>
</g>
<!-- proc~identify_stencilneigh -->
<g id="proc~~request_remotehalos~~CallsGraph_node11" class="node">
<title>proc~identify_stencilneigh</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node11"><a xlink:href="../proc/identify_stencilneigh.html" xlink:title="identify_stencilNeigh">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-398 355,-398 355,-374 478,-374 478,-398"/>
<text text-anchor="middle" x="416.5" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">identify_stencilNeigh</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;proc~identify_stencilneigh -->
<g id="proc~~request_remotehalos~~CallsGraph_edge10" class="edge">
<title>proc~request_remotehalos&#45;&gt;proc~identify_stencilneigh</title>
<path fill="none" stroke="#000000" d="M69.47,-254.16C81.77,-279.88 114.31,-339.54 162,-365 218.18,-394.99 291.51,-397.86 344.83,-394.64"/>
<polygon fill="#000000" stroke="#000000" points="345.15,-398.13 354.89,-393.95 344.67,-391.14 345.15,-398.13"/>
</g>
<!-- proc~tem_abort -->
<g id="proc~~request_remotehalos~~CallsGraph_node12" class="node">
<title>proc~tem_abort</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node12"><a xlink:href="../proc/tem_abort.html" xlink:title="tem_abort">
<polygon fill="#d9534f" stroke="#d9534f" points="271.5,-66 204.5,-66 204.5,-42 271.5,-42 271.5,-66"/>
<text text-anchor="middle" x="238" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_abort</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;proc~tem_abort -->
<g id="proc~~request_remotehalos~~CallsGraph_edge11" class="edge">
<title>proc~request_remotehalos&#45;&gt;proc~tem_abort</title>
<path fill="none" stroke="#000000" d="M67.62,-229.77C77.41,-198.85 107.41,-117.06 162,-75 171.36,-67.79 183.07,-63.05 194.44,-59.94"/>
<polygon fill="#000000" stroke="#000000" points="195.35,-63.32 204.27,-57.61 193.73,-56.51 195.35,-63.32"/>
</g>
<!-- proc~tem_horizontalspacer -->
<g id="proc~~request_remotehalos~~CallsGraph_node13" class="node">
<title>proc~tem_horizontalspacer</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node13"><a xlink:href="../proc/tem_horizontalspacer.html" xlink:title="tem_horizontalSpacer">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-24 173,-24 173,0 303,0 303,-24"/>
<text text-anchor="middle" x="238" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_horizontalSpacer</text>
</a>
</g>
</g>
<!-- proc~request_remotehalos&#45;&gt;proc~tem_horizontalspacer -->
<g id="proc~~request_remotehalos~~CallsGraph_edge12" class="edge">
<title>proc~request_remotehalos&#45;&gt;proc~tem_horizontalspacer</title>
<path fill="none" stroke="#000000" d="M66.04,-229.96C72.74,-194.19 97.47,-87.65 162,-33 163.55,-31.69 165.17,-30.46 166.86,-29.31"/>
<polygon fill="#000000" stroke="#000000" points="168.84,-32.2 175.74,-24.16 165.33,-26.15 168.84,-32.2"/>
</g>
<!-- proc~append_ga_dynlong -->
<g id="proc~~request_remotehalos~~CallsGraph_node16" class="node">
<title>proc~append_ga_dynlong</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node16"><a xlink:href="../proc/append_ga_dynlong.html" xlink:title="append_ga_dynlong">
<polygon fill="#d9534f" stroke="#d9534f" points="651,-541 531,-541 531,-517 651,-517 651,-541"/>
<text text-anchor="middle" x="591" y="-526.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append_ga_dynlong</text>
</a>
</g>
</g>
<!-- interface~append~11&#45;&gt;proc~append_ga_dynlong -->
<g id="proc~~request_remotehalos~~CallsGraph_edge13" class="edge">
<title>interface~append~11&#45;&gt;proc~append_ga_dynlong</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M443.7,-511.19C464.17,-513.68 493.61,-517.27 520.72,-520.57"/>
<polygon fill="#000000" stroke="#000000" points="520.63,-524.08 530.98,-521.81 521.47,-517.13 520.63,-524.08"/>
</g>
<!-- proc~append_ga_dynlong_vec -->
<g id="proc~~request_remotehalos~~CallsGraph_node17" class="node">
<title>proc~append_ga_dynlong_vec</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node17"><a xlink:href="../proc/append_ga_dynlong_vec.html" xlink:title="append_ga_dynlong_vec">
<polygon fill="#d9534f" stroke="#d9534f" points="663,-499 519,-499 519,-475 663,-475 663,-499"/>
<text text-anchor="middle" x="591" y="-484.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append_ga_dynlong_vec</text>
</a>
</g>
</g>
<!-- interface~append~11&#45;&gt;proc~append_ga_dynlong_vec -->
<g id="proc~~request_remotehalos~~CallsGraph_edge14" class="edge">
<title>interface~append~11&#45;&gt;proc~append_ga_dynlong_vec</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M443.7,-504.81C461.18,-502.68 485.2,-499.76 508.73,-496.89"/>
<polygon fill="#000000" stroke="#000000" points="509.25,-500.36 518.76,-495.67 508.41,-493.41 509.25,-500.36"/>
</g>
<!-- proc~destroy_ga2d_real -->
<g id="proc~~request_remotehalos~~CallsGraph_node18" class="node">
<title>proc~destroy_ga2d_real</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node18"><a xlink:href="../proc/destroy_ga2d_real.html" xlink:title="destroy_ga2d_real">
<polygon fill="#d9534f" stroke="#d9534f" points="471,-356 362,-356 362,-332 471,-332 471,-356"/>
<text text-anchor="middle" x="416.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">destroy_ga2d_real</text>
</a>
</g>
</g>
<!-- interface~destroy~25&#45;&gt;proc~destroy_ga2d_real -->
<g id="proc~~request_remotehalos~~CallsGraph_edge15" class="edge">
<title>interface~destroy~25&#45;&gt;proc~destroy_ga2d_real</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M265.04,-344C287.77,-344 321.71,-344 351.6,-344"/>
<polygon fill="#000000" stroke="#000000" points="351.98,-347.5 361.98,-344 351.98,-340.5 351.98,-347.5"/>
</g>
<!-- proc~init_ga2d_real -->
<g id="proc~~request_remotehalos~~CallsGraph_node21" class="node">
<title>proc~init_ga2d_real</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node21"><a xlink:href="../proc/init_ga2d_real.html" xlink:title="init_ga2d_real">
<polygon fill="#d9534f" stroke="#d9534f" points="460,-314 373,-314 373,-290 460,-290 460,-314"/>
<text text-anchor="middle" x="416.5" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_ga2d_real</text>
</a>
</g>
</g>
<!-- interface~init~24&#45;&gt;proc~init_ga2d_real -->
<g id="proc~~request_remotehalos~~CallsGraph_edge16" class="edge">
<title>interface~init~24&#45;&gt;proc~init_ga2d_real</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M265.04,-302C290.66,-302 330.49,-302 362.74,-302"/>
<polygon fill="#000000" stroke="#000000" points="362.91,-305.5 372.91,-302 362.91,-298.5 362.91,-305.5"/>
</g>
<!-- proc~posofval_label -->
<g id="proc~~request_remotehalos~~CallsGraph_node22" class="node">
<title>proc~posofval_label</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node22"><a xlink:href="../proc/posofval_label.html" xlink:title="posofval_label">
<polygon fill="#d94e8f" stroke="#d94e8f" points="635.5,-272 546.5,-272 546.5,-248 635.5,-248 635.5,-272"/>
<text text-anchor="middle" x="591" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">posofval_label</text>
</a>
</g>
</g>
<!-- interface~positionofval~5&#45;&gt;proc~posofval_label -->
<g id="proc~~request_remotehalos~~CallsGraph_edge17" class="edge">
<title>interface~positionofval~5&#45;&gt;proc~posofval_label</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M457.07,-260C480.5,-260 510.51,-260 536.08,-260"/>
<polygon fill="#000000" stroke="#000000" points="536.37,-263.5 546.37,-260 536.37,-256.5 536.37,-263.5"/>
</g>
<!-- proc~create_allparentneighbors&#45;&gt;interface~append~11 -->
<g id="proc~~request_remotehalos~~CallsGraph_edge18" class="edge">
<title>proc~create_allparentneighbors&#45;&gt;interface~append~11</title>
<path fill="none" stroke="#000000" d="M262.58,-440.11C284.88,-451.41 319.41,-468.51 350,-482 359.66,-486.26 370.24,-490.6 380.03,-494.48"/>
<polygon fill="#000000" stroke="#000000" points="378.91,-497.8 389.49,-498.19 381.46,-491.28 378.91,-497.8"/>
</g>
<!-- proc~create_allparentneighbors&#45;&gt;proc~identify_stencilneigh -->
<g id="proc~~request_remotehalos~~CallsGraph_edge21" class="edge">
<title>proc~create_allparentneighbors&#45;&gt;proc~identify_stencilneigh</title>
<path fill="none" stroke="#000000" d="M289.58,-415.96C309.98,-411.11 333.69,-405.47 355,-400.4"/>
<polygon fill="#000000" stroke="#000000" points="356,-403.76 364.91,-398.04 354.38,-396.95 356,-403.76"/>
</g>
<!-- interface~tem_parentof -->
<g id="proc~~request_remotehalos~~CallsGraph_node14" class="node">
<title>interface~tem_parentof</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node14"><a xlink:href="../interface/tem_parentof.html" xlink:title="tem_ParentOf">
<polygon fill="#a7506f" stroke="#a7506f" points="459,-440 374,-440 374,-416 459,-416 459,-440"/>
<text text-anchor="middle" x="416.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_ParentOf</text>
</a>
</g>
</g>
<!-- proc~create_allparentneighbors&#45;&gt;interface~tem_parentof -->
<g id="proc~~request_remotehalos~~CallsGraph_edge19" class="edge">
<title>proc~create_allparentneighbors&#45;&gt;interface~tem_parentof</title>
<path fill="none" stroke="#000000" d="M314.11,-428C330.73,-428 347.98,-428 363.44,-428"/>
<polygon fill="#000000" stroke="#000000" points="363.83,-431.5 373.83,-428 363.83,-424.5 363.83,-431.5"/>
</g>
<!-- proc~identify_elements -->
<g id="proc~~request_remotehalos~~CallsGraph_node19" class="node">
<title>proc~identify_elements</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node19"><a xlink:href="../proc/identify_elements.html" xlink:title="identify_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="644.5,-438 537.5,-438 537.5,-414 644.5,-414 644.5,-438"/>
<text text-anchor="middle" x="591" y="-423.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">identify_elements</text>
</a>
</g>
</g>
<!-- proc~create_allparentneighbors&#45;&gt;proc~identify_elements -->
<g id="proc~~request_remotehalos~~CallsGraph_edge20" class="edge">
<title>proc~create_allparentneighbors&#45;&gt;proc~identify_elements</title>
<path fill="none" stroke="#000000" d="M291.51,-440.02C309.9,-443.67 330.77,-447.2 350,-449 408.85,-454.52 424.22,-455.25 483,-449 499.82,-447.21 517.88,-443.89 534.29,-440.31"/>
<polygon fill="#000000" stroke="#000000" points="535.28,-443.67 544.26,-438.06 533.74,-436.85 535.28,-443.67"/>
</g>
<!-- proc~identify_halo&#45;&gt;interface~positionofval~5 -->
<g id="proc~~request_remotehalos~~CallsGraph_edge22" class="edge">
<title>proc~identify_halo&#45;&gt;interface~positionofval~5</title>
<path fill="none" stroke="#000000" d="M278.61,-230.53C304.41,-236.08 338.27,-243.37 365.86,-249.31"/>
<polygon fill="#000000" stroke="#000000" points="365.2,-252.75 375.72,-251.43 366.68,-245.91 365.2,-252.75"/>
</g>
<!-- proc~identify_local_element -->
<g id="proc~~request_remotehalos~~CallsGraph_node20" class="node">
<title>proc~identify_local_element</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node20"><a xlink:href="../proc/identify_local_element.html" xlink:title="identify_local_element">
<polygon fill="#d9534f" stroke="#d9534f" points="483,-230 350,-230 350,-206 483,-206 483,-230"/>
<text text-anchor="middle" x="416.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">identify_local_element</text>
</a>
</g>
</g>
<!-- proc~identify_halo&#45;&gt;proc~identify_local_element -->
<g id="proc~~request_remotehalos~~CallsGraph_edge23" class="edge">
<title>proc~identify_halo&#45;&gt;proc~identify_local_element</title>
<path fill="none" stroke="#000000" d="M278.61,-221.1C296.6,-220.69 318.52,-220.2 339.49,-219.72"/>
<polygon fill="#000000" stroke="#000000" points="339.78,-223.22 349.69,-219.49 339.62,-216.22 339.78,-223.22"/>
</g>
<!-- proc~tem_levelof -->
<g id="proc~~request_remotehalos~~CallsGraph_node23" class="node">
<title>proc~tem_levelof</title>
<g id="a_proc~~request_remotehalos~~CallsGraph_node23"><a xlink:href="../proc/tem_levelof.html" xlink:title="tem_LevelOf">
<polygon fill="#d94e8f" stroke="#d94e8f" points="456,-188 377,-188 377,-164 456,-164 456,-188"/>
<text text-anchor="middle" x="416.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_LevelOf</text>
</a>
</g>
</g>
<!-- proc~identify_halo&#45;&gt;proc~tem_levelof -->
<g id="proc~~request_remotehalos~~CallsGraph_edge24" class="edge">
<title>proc~identify_halo&#45;&gt;proc~tem_levelof</title>
<path fill="none" stroke="#000000" d="M278.61,-211.68C304.77,-204.86 339.22,-195.88 367.02,-188.63"/>
<polygon fill="#000000" stroke="#000000" points="368.14,-191.96 376.93,-186.05 366.37,-185.19 368.14,-191.96"/>
</g>
<!-- proc~identify_stencilneigh&#45;&gt;proc~identify_elements -->
<g id="proc~~request_remotehalos~~CallsGraph_edge25" class="edge">
<title>proc~identify_stencilneigh&#45;&gt;proc~identify_elements</title>
<path fill="none" stroke="#000000" d="M469.26,-398C487.76,-402.29 508.81,-407.17 528.09,-411.64"/>
<polygon fill="#000000" stroke="#000000" points="527.45,-415.09 537.98,-413.94 529.03,-408.27 527.45,-415.09"/>
</g>
<!-- mpi_abort -->
<g id="proc~~request_remotehalos~~CallsGraph_node15" class="node">
<title>mpi_abort</title>
<polygon fill="#777777" stroke="#777777" points="450,-66 383,-66 383,-42 450,-42 450,-66"/>
<text text-anchor="middle" x="416.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_abort</text>
</g>
<!-- proc~tem_abort&#45;&gt;mpi_abort -->
<g id="proc~~request_remotehalos~~CallsGraph_edge26" class="edge">
<title>proc~tem_abort&#45;&gt;mpi_abort</title>
<path fill="none" stroke="#000000" d="M271.78,-54C300.27,-54 341.71,-54 372.78,-54"/>
<polygon fill="#000000" stroke="#000000" points="372.89,-57.5 382.89,-54 372.89,-50.5 372.89,-57.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocrequest_remotehalosCallsGraph = svgPanZoom('#procrequest_remotehalosCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~request_remotehalos~~CalledByGraph Pages: 1 -->
<svg id="procrequest_remotehalosCalledByGraph" width="641pt" height="24pt"
 viewBox="0.00 0.00 641.00 24.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~request_remotehalos~~CalledByGraph" class="graph" transform="scale(0.76 0.76) rotate(0) translate(4 28)">
<title>proc~~request_remotehalos~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 838,-28 838,4 -4,4"/>
<!-- proc~request_remotehalos -->
<g id="proc~~request_remotehalos~~CalledByGraph_node1" class="node">
<title>proc~request_remotehalos</title>
<polygon fill="none" stroke="black" points="834,-24 708,-24 708,0 834,0 834,-24"/>
<text text-anchor="middle" x="771" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">request_remoteHalos</text>
</g>
<!-- proc~communicate_elements -->
<g id="proc~~request_remotehalos~~CalledByGraph_node2" class="node">
<title>proc~communicate_elements</title>
<g id="a_proc~~request_remotehalos~~CalledByGraph_node2"><a xlink:href="../proc/communicate_elements.html" xlink:title="communicate_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="672,-24 531,-24 531,0 672,0 672,-24"/>
<text text-anchor="middle" x="601.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">communicate_elements</text>
</a>
</g>
</g>
<!-- proc~communicate_elements&#45;&gt;proc~request_remotehalos -->
<g id="proc~~request_remotehalos~~CalledByGraph_edge1" class="edge">
<title>proc~communicate_elements&#45;&gt;proc~request_remotehalos</title>
<path fill="none" stroke="#000000" d="M672.08,-12C680.51,-12 689.15,-12 697.62,-12"/>
<polygon fill="#000000" stroke="#000000" points="697.86,-15.5 707.86,-12 697.86,-8.5 697.86,-15.5"/>
</g>
<!-- proc~tem_find_allelements -->
<g id="proc~~request_remotehalos~~CalledByGraph_node3" class="node">
<title>proc~tem_find_allelements</title>
<g id="a_proc~~request_remotehalos~~CalledByGraph_node3"><a xlink:href="../proc/tem_find_allelements.html" xlink:title="tem_find_allElements">
<polygon fill="#d9534f" stroke="#d9534f" points="495,-24 368,-24 368,0 495,0 495,-24"/>
<text text-anchor="middle" x="431.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_find_allElements</text>
</a>
</g>
</g>
<!-- proc~tem_find_allelements&#45;&gt;proc~communicate_elements -->
<g id="proc~~request_remotehalos~~CalledByGraph_edge2" class="edge">
<title>proc~tem_find_allelements&#45;&gt;proc~communicate_elements</title>
<path fill="none" stroke="#000000" d="M495.06,-12C503.44,-12 512.13,-12 520.75,-12"/>
<polygon fill="#000000" stroke="#000000" points="520.83,-15.5 530.83,-12 520.83,-8.5 520.83,-15.5"/>
</g>
<!-- proc~tem_create_leveldesc -->
<g id="proc~~request_remotehalos~~CalledByGraph_node4" class="node">
<title>proc~tem_create_leveldesc</title>
<g id="a_proc~~request_remotehalos~~CalledByGraph_node4"><a xlink:href="../proc/tem_create_leveldesc.html" xlink:title="tem_create_levelDesc">
<polygon fill="#d9534f" stroke="#d9534f" points="332,-24 202,-24 202,0 332,0 332,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_create_levelDesc</text>
</a>
</g>
</g>
<!-- proc~tem_create_leveldesc&#45;&gt;proc~tem_find_allelements -->
<g id="proc~~request_remotehalos~~CalledByGraph_edge3" class="edge">
<title>proc~tem_create_leveldesc&#45;&gt;proc~tem_find_allelements</title>
<path fill="none" stroke="#000000" d="M332.22,-12C340.55,-12 349.12,-12 357.58,-12"/>
<polygon fill="#000000" stroke="#000000" points="357.8,-15.5 367.8,-12 357.8,-8.5 357.8,-15.5"/>
</g>
<!-- proc~tem_dimbydim_construction -->
<g id="proc~~request_remotehalos~~CalledByGraph_node5" class="node">
<title>proc~tem_dimbydim_construction</title>
<g id="a_proc~~request_remotehalos~~CalledByGraph_node5"><a xlink:href="../proc/tem_dimbydim_construction.html" xlink:title="tem_dimByDim_construction">
<polygon fill="#d9534f" stroke="#d9534f" points="166,-24 0,-24 0,0 166,0 166,-24"/>
<text text-anchor="middle" x="83" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_dimByDim_construction</text>
</a>
</g>
</g>
<!-- proc~tem_dimbydim_construction&#45;&gt;proc~tem_create_leveldesc -->
<g id="proc~~request_remotehalos~~CalledByGraph_edge4" class="edge">
<title>proc~tem_dimbydim_construction&#45;&gt;proc~tem_create_leveldesc</title>
<path fill="none" stroke="#000000" d="M166.21,-12C174.72,-12 183.33,-12 191.74,-12"/>
<polygon fill="#000000" stroke="#000000" points="191.88,-15.5 201.88,-12 191.88,-8.5 191.88,-15.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocrequest_remotehalosCalledByGraph = svgPanZoom('#procrequest_remotehalosCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">request_remoteHalos</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">,</span><span class="w"> </span><span class="n">proc</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">iLevel</span><span class="p">,</span><span class="w"> </span><span class="n">stencil</span><span class="p">,&amp;</span>
<span class="w">    </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">pathFirst</span><span class="p">,</span><span class="w"> </span><span class="n">pathLast</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">!&gt; the global tree</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">treelmesh_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tree</span>
<span class="w">    </span><span class="c">!&gt; the level descriptor to be filled</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_levelDesc_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">tree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">minlevel</span><span class="p">:</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="c">!&gt; Process description to use.</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_comm_env_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">proc</span>
<span class="w">    </span><span class="c">!&gt; current level</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iLevel</span>
<span class="w">    </span><span class="c">!&gt; stencil definition</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_stencilHeader_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">stencil</span>
<span class="w">    </span><span class="c">!&gt; first and last treeID path in every process</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_path_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pathFirst</span><span class="p">(:),</span><span class="w"> </span><span class="n">pathLast</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------------</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iProc</span><span class="p">,</span><span class="w"> </span><span class="n">iErr</span><span class="p">,</span><span class="w"> </span><span class="n">iElem</span><span class="p">,</span><span class="w"> </span><span class="n">elemPos</span><span class="p">,</span><span class="w"> </span><span class="n">procPos</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">haloLevel</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rq_handle</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="p">(:,:</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nCommunications</span><span class="p">,</span><span class="w"> </span><span class="n">nesting</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="w"> </span><span class="n">grw_longArray_type</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">treeIDs_fromTarget</span><span class="p">(:)</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="w"> </span><span class="n">grw_intArray_type</span><span class="w"> </span><span class="p">),</span><span class="w">  </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(:)</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="w"> </span><span class="n">grw_longArray_type</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">treeIDs_toSource</span><span class="p">(:)</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="w"> </span><span class="n">grw_intArray_type</span><span class="w"> </span><span class="p">),</span><span class="w">  </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nestings_toSource</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">updated</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">message_flag_long</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">message_flag_int</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------------</span>

<span class="w">    </span><span class="k">call </span><span class="n">tem_horizontalSpacer</span><span class="p">(</span><span class="w"> </span><span class="n">fUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Get into routine: request_remoteHalos&quot;</span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Requesting remote halos on level: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iLevel</span>

<span class="w">    </span><span class="c">! two communications: treeID and nesting</span>
<span class="w">    </span><span class="n">nCommunications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">rq_handle</span><span class="p">(</span><span class="w"> </span><span class="n">nCommunications</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_status_size</span><span class="p">,</span><span class="w"> </span><span class="n">nCommunications</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="n">rq_handle</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_REQUEST_NULL</span>

<span class="w">    </span><span class="c">! Warning: Inverse Communication ! (send to source, recv from target)</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! I receive from target what elements are needed by them</span>
<span class="w">    </span><span class="c">! SendBuffer contains my elements required by remote targets</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w">  </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">))</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">))</span>

<span class="w">    </span><span class="k">do </span><span class="n">iProc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span>

<span class="w">      </span><span class="c">! Allocate the buffers</span>
<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">))</span>
<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                     </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">))</span>

<span class="w">      </span><span class="c">! Receive the element tree IDs</span>
<span class="w">      </span><span class="k">call </span><span class="n">mpi_irecv</span><span class="p">(</span><span class="w"> </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">val</span><span class="p">,</span><span class="w">                         </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">ContainerSize</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">mpi_integer8</span><span class="p">,</span><span class="w">                                            </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">proc</span><span class="p">(</span><span class="n">iProc</span><span class="p">),</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">message_flag_long</span><span class="p">,</span><span class="w">                                       </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">proc</span><span class="p">%</span><span class="n">comm</span><span class="p">,</span><span class="w">                                               </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">rq_handle</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="p">),</span><span class="w">                                       </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">iErr</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="c">! Receive the element nestings</span>
<span class="w">      </span><span class="k">call </span><span class="n">mpi_irecv</span><span class="p">(</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">val</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">ContainerSize</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">mpi_integer</span><span class="p">,</span><span class="w">                                             </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">proc</span><span class="p">(</span><span class="n">iProc</span><span class="p">),</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">message_flag_int</span><span class="p">,</span><span class="w">                                        </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">proc</span><span class="p">%</span><span class="n">comm</span><span class="p">,</span><span class="w">                                               </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">rq_handle</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="o">+</span><span class="n">nCommunications</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">             </span><span class="n">iErr</span><span class="w">  </span><span class="p">)</span>
<span class="w">      </span><span class="c">! Update the number of elements inside the growing array of the recv</span>
<span class="w">      </span><span class="c">! buffer</span>
<span class="w">       </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">nVals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">ContainerSize</span>
<span class="w">      </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">nVals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">ContainerSize</span>
<span class="w">    </span><span class="k">end do</span><span class="w"> </span><span class="c">! iProc</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------</span>

<span class="w">    </span><span class="c">! ---------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! I send to source what elements I need from them</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w">  </span><span class="n">treeIDs_toSource</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">nestings_toSource</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="k">do </span><span class="n">iProc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nProcs</span>

<span class="w">      </span><span class="c">! Get the position of the process in the dynamic halos list (might be</span>
<span class="w">      </span><span class="c">! unordered)</span>
<span class="w">      </span><span class="n">procPos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PositionOfVal</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">iLevel</span><span class="p">)%</span><span class="n">haloList</span><span class="p">%</span><span class="n">PartnerProc</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">                      </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">iLevel</span><span class="p">)%</span><span class="n">recvbuffer</span><span class="w">            </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">                                             </span><span class="p">%</span><span class="n">proc</span><span class="p">(</span><span class="n">iProc</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">       </span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w">  </span><span class="n">me</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">treeIDs_toSource</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">         </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">))</span>
<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w">  </span><span class="n">me</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nestings_toSource</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                       </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">         </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">))</span>

<span class="w">      </span><span class="c">! Collect the halo treeIDs into send buffers for all the processes to</span>
<span class="w">      </span><span class="c">! request from</span>
<span class="w">      </span><span class="k">do </span><span class="n">iElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="n">elemPos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">haloList</span><span class="p">%</span><span class="n">halos</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">procPos</span><span class="p">)%</span><span class="n">val</span><span class="p">(</span><span class="n">iElem</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">treeIDs_toSource</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">tID</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">nestings_toSource</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                         </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">haloNesting</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>

<span class="w">      </span><span class="c">! Send treeIDs</span>
<span class="w">      </span><span class="k">call </span><span class="n">mpi_isend</span><span class="p">(</span><span class="w">                                                           </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">treeIDs_toSource</span><span class="p">(</span><span class="n">iProc</span><span class="p">)%</span><span class="n">val</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">treeIDs_toSource</span><span class="p">(</span><span class="n">iProc</span><span class="p">)%</span><span class="n">nVals</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">mpi_integer8</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">proc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">message_flag_long</span><span class="p">,</span><span class="w">                                             </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">proc</span><span class="p">%</span><span class="n">comm</span><span class="p">,</span><span class="w">                                                     </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">rq_handle</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ierr</span><span class="w">  </span><span class="p">)</span>
<span class="w">      </span><span class="c">! Send nesting</span>
<span class="w">      </span><span class="k">call </span><span class="n">mpi_isend</span><span class="p">(</span><span class="w">                                                           </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">nestings_toSource</span><span class="p">(</span><span class="n">iProc</span><span class="p">)%</span><span class="n">val</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">nestings_toSource</span><span class="p">(</span><span class="n">iProc</span><span class="p">)%</span><span class="n">nVals</span><span class="p">,</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">mpi_integer</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">recvbuffer</span><span class="p">%</span><span class="n">proc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">message_flag_int</span><span class="p">,</span><span class="w">                                              </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">proc</span><span class="p">%</span><span class="n">comm</span><span class="p">,</span><span class="w">                                                     </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">rq_handle</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="n">nCommunications</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w">                         </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ierr</span><span class="w">  </span><span class="p">)</span>

<span class="w">    </span><span class="k">end do</span><span class="w"> </span><span class="c">! iProc</span>

<span class="w">    </span><span class="k">call </span><span class="n">mpi_waitall</span><span class="p">(</span><span class="w"> </span><span class="n">nCommunications</span><span class="p">,</span><span class="w"> </span><span class="n">rq_handle</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">logUnit</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;  Received requested halo elements successfully.&#39;</span>
<span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w">  </span><span class="n">treeIDs_toSource</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">nestings_toSource</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w">         </span><span class="n">rq_handle</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w">         </span><span class="n">status</span><span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="c">! Requested halo elements were received.</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------------</span>

<span class="w">    </span><span class="c">! ---------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Now identify the requested halos.</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="p">%</span><span class="n">elemPos</span><span class="p">))</span><span class="w">         </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">         </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="p">%</span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w">               </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                                </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">))</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="p">%</span><span class="n">elemPos</span><span class="w"> </span><span class="p">))</span><span class="w">          </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">           </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="p">%</span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w">                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                                </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span><span class="w"> </span><span class="p">))</span>

<span class="w">    </span><span class="c">! Add elements of received buffers to elem</span>
<span class="w">    </span><span class="k">do </span><span class="n">iProc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nProcs</span>
<span class="w">      </span><span class="c">! Allocate the buffer for the element position indices</span>
<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="n">iProc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="n">iProc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="n">iProc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">      </span><span class="k">do </span><span class="n">iElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">nVals</span>
<span class="w">        </span><span class="n">nesting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">val</span><span class="p">(</span><span class="w"> </span><span class="n">iElem</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="c">! identify requested halo treeID in local process</span>
<span class="w">        </span><span class="k">call </span><span class="n">identify_halo</span><span class="p">(</span><span class="w"> </span><span class="n">haloTreeID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">val</span><span class="p">(</span><span class="n">iElem</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">elemPos</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">elemPos</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">halolevel</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">haloLevel</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">levelDesc</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">nesting</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">nesting</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">updated</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">tree</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">minLevel</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">minLevel</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span>
<span class="w">          </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">stencil</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="c">! if requested halo is ghostFromCoarser then find stencil neighbors of</span>
<span class="w">          </span><span class="c">! this halo element</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">nesting</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nestingLimit</span><span class="p">)</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">            </span><span class="p">&amp;</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">eType</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">elemPos</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">            </span><span class="p">&amp;</span><span class="w">         </span><span class="o">==</span><span class="w"> </span><span class="n">eT_ghostFromCoarser</span><span class="p">)</span><span class="w">                     </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! identify all the compute neighbors of the current element</span>
<span class="w">            </span><span class="k">call </span><span class="n">identify_stencilNeigh</span><span class="p">(</span><span class="w"> </span><span class="n">iElem</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">elemPos</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">iLevel</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">iLevel</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">tree</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">iStencil</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">pathFirst</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">pathFirst</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">pathLast</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">pathLast</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">levelDesc</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">proc</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">proc</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">stencil</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">nesting</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">nesting</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">          </span><span class="k">end if</span>

<span class="w">          </span><span class="c">! if requested halo element haloNesting &lt; found halo element (elemPos)</span>
<span class="w">          </span><span class="c">! haloNesting</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="n">iProc</span><span class="p">)%</span><span class="n">val</span><span class="p">(</span><span class="n">iElem</span><span class="p">)</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">            </span><span class="p">&amp;</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">haloLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">haloNesting</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">elemPos</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">haloLevel</span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">needsUpdate</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">elemPos</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">            </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">haloLevel</span><span class="p">)</span><span class="w">                                             </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="p">%</span><span class="n">elem</span><span class="w">                                                       </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="p">%</span><span class="n">haloNesting</span><span class="w">                                                </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">  </span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">elemPos</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="n">iProc</span><span class="p">)%</span><span class="n">val</span><span class="p">(</span><span class="n">iElem</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">haloLevel</span><span class="p">)</span><span class="w">                   </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="p">%</span><span class="n">elem</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="p">%</span><span class="n">haloNesting</span><span class="w">                         </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                         </span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">elemPos</span><span class="p">)</span><span class="w">                        </span><span class="p">)</span>
<span class="w">          </span><span class="k">end if</span>

<span class="w">          </span><span class="c">! only add, if the element was added locally</span>
<span class="w">          </span><span class="k">select case</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">iLevel</span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">eType</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">elemPos</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">          </span><span class="c">! Depending on the type of the element, add to the</span>
<span class="w">          </span><span class="c">! regular buffer, bufferFromCoarser, bufferFromFiner</span>
<span class="w">          </span><span class="k">case</span><span class="p">(</span><span class="w"> </span><span class="n">eT_fluid</span><span class="w"> </span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span>
<span class="w">          </span><span class="k">case</span><span class="p">(</span><span class="w"> </span><span class="n">eT_ghostFromCoarser</span><span class="w"> </span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                                             </span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span>

<span class="w">            </span><span class="c">! for ghostFromCoarser determine neighbors of coarser element</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">haloLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">haloNesting</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                                        </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nestingLimit</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">create_allParentNeighbors</span><span class="p">(</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">targetID</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="n">iLevel</span><span class="p">)%</span><span class="n">elem</span><span class="p">%</span><span class="n">tID</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">level</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">iLevel</span><span class="p">,</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">tree</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">stencil</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">levelDesc</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">pathFirst</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">pathFirst</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">pathLast</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">pathLast</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">      </span><span class="n">proc</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">proc</span><span class="w"> </span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">          case</span><span class="p">(</span><span class="w"> </span><span class="n">eT_ghostFromFiner</span><span class="w"> </span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="w">         </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">                </span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">),</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elemPos</span><span class="w"> </span><span class="p">)</span>
<span class="w">          </span><span class="k">case</span><span class="p">(</span><span class="w"> </span><span class="n">eT_distributedGhostFromFiner</span><span class="p">)</span>
<span class="w">             </span><span class="k">write</span><span class="p">(</span><span class="n">logUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39; Found distributed ghost From Finer in &#39;</span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">               </span><span class="p">&amp;</span><span class="w">                </span><span class="s1">&#39;request remote Halos&#39;</span>
<span class="w">             </span><span class="k">write</span><span class="p">(</span><span class="n">logUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39; This case should not occur!&#39;</span>
<span class="w">             </span><span class="k">call </span><span class="n">tem_abort</span><span class="p">()</span>
<span class="w">          </span><span class="k">end select</span>
<span class="k">        end if</span><span class="w"> </span><span class="c">! elemPos &gt; 0</span>
<span class="w">      </span><span class="k">end do</span><span class="w"> </span><span class="c">! ielem recvbuffer</span>

<span class="w">      </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)</span><span class="w">                       </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbuffer</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">nVals</span>
<span class="w">      </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)</span><span class="w">            </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromCoarser</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">nVals</span>
<span class="w">      </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="p">%</span><span class="n">nElemsProc</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">levelDesc</span><span class="p">(</span><span class="w"> </span><span class="n">iLevel</span><span class="w"> </span><span class="p">)%</span><span class="n">sendbufferFromFiner</span><span class="p">%</span><span class="n">elemPos</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)%</span><span class="n">nVals</span>

<span class="w">      </span><span class="c">! destroy temp variables</span>
<span class="w">      </span><span class="k">call </span><span class="n">destroy</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">treeIDs_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">destroy</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="p">(</span><span class="w"> </span><span class="n">iProc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span><span class="w"> </span><span class="c">! iProc</span>
<span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w">  </span><span class="n">treeIDs_fromTarget</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">nestings_fromTarget</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="c">! Now each Process knows, which elements to send to others</span>
<span class="w">    </span><span class="c">! ---------------------------------------------------------------------</span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">logUnit</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Finished requesting remote halos&#39;</span>

<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Leave  routine: request_remoteHalos&quot;</span>
<span class="w">    </span><span class="k">call </span><span class="n">tem_horizontalSpacer</span><span class="p">(</span><span class="w"> </span><span class="n">fUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">request_remoteHalos</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Treelm
 was developed by University of Siegen<br>              &copy; 2024 
<br /><small>f49cf9b176ae</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-11-11T17:20:36.336178             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>