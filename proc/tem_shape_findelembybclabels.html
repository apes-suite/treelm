<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Tree based Elemental Mesh">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>tem_shape_findElemByBCLabels &ndash; Treelm</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Treelm </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">TreElm Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tem_shape_findElemByBCLabels
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.3% of total for procedures.">90 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tem_shape_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tem_shape_module.f90.html'>tem_shape_module.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/tem_shape_module.html'>tem_shape_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">tem_shape_findElemByBCLabels</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/tem_shape_findelembybclabels.html#src">tem_shape_findElemByBCLabels</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine tem_shape_findElemByBCLabels(bcLabels, cutOffQVal, bc_prop, foundAny, map2global, inTree, countPoints, grwPnts, storePnts, bcIDs, stencil)  
</h2>
    

    <p>This routine identifies elements that belong to certain bounaries.
Labels of required boundaries are given by bcLabels.
bc_prop contains boudnary_ID of all local elements.
Firstly, bcLabels are converted into bcIDs.
Then all elements in bc_prop are looped over to check if it matches one of
the required bcID. If match, its position is save in map2global.
Number of elements found on each level is saved in countElems.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bclabels~4"></span>
              character(len=labelLen),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bcLabels</strong>(:)</td>
            <td>
                <p>bcLabels</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cutoffqval~2"></span>
              real(kind=rk),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>cutOffQVal</strong></td>
            <td>
                <p>Cut off qValue</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bc_prop"></span>
              type(<a href='../type/tem_bc_prop_type.html'>tem_BC_prop_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bc_prop</strong></td>
            <td>
                <p>bc property</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-foundany~2"></span>
              logical,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>foundAny</strong></td>
            <td>
                <p>if any element be identified</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-map2global~2"></span>
              type(<a href='../type/dyn_intarray_type.html'>dyn_intarray_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>map2global</strong></td>
            <td>
                <p>dynamic array. Elements positions in bc_prop%property%elemID</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-intree~2"></span>
              type(<a href='../type/treelmesh_type.html'>treelmesh_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>inTree</strong></td>
            <td>
                <p>Global tree</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-countpoints~2"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>countPoints</strong></td>
            <td>
                <p>How many points there will be</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-grwpnts~2"></span>
              type(<a href='../type/tem_grwpoints_type.html'>tem_grwPoints_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grwPnts</strong></td>
            <td>
                <p>growing array to store tracking points</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-storepnts~2"></span>
              logical,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>storePnts</strong></td>
            <td>
                <p>to Store points in grwPnts</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bcids"></span>
              integer,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>bcIDs</strong>(:)</td>
            <td>
                <p>id of boundary condition to be tracked</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stencil"></span>
              type(<a href='../type/tem_stencilheader_type.html'>tem_stencilHeader_type</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>stencil</strong></td>
            <td>
                <p>stencil required to get useful links</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~tem_shape_findelembybclabels~~CallsGraph Pages: 1 -->
<svg id="proctem_shape_findelembybclabelsCallsGraph" width="641pt" height="148pt"
 viewBox="0.00 0.00 641.00 147.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 168.36)">
<title>proc~~tem_shape_findelembybclabels~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-168.36 744,-168.36 744,4 -4,4"/>
<!-- proc~tem_shape_findelembybclabels -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node1" class="node">
<title>proc~tem_shape_findelembybclabels</title>
<polygon fill="none" stroke="black" points="186,-80.36 0,-80.36 0,-56.36 186,-56.36 186,-80.36"/>
<text text-anchor="middle" x="93" y="-65.96" font-family="Helvetica,sans-Serif" font-size="10.50">tem_shape_findElemByBCLabels</text>
</g>
<!-- interface~append~19 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node2" class="node">
<title>interface~append~19</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node2"><a xlink:href="../interface/append~19.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="293,-122.36 239,-122.36 239,-98.36 293,-98.36 293,-122.36"/>
<text text-anchor="middle" x="266" y="-107.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- proc~tem_shape_findelembybclabels&#45;&gt;interface~append~19 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge1" class="edge">
<title>proc~tem_shape_findelembybclabels&#45;&gt;interface~append~19</title>
<path fill="none" stroke="#000000" d="M143,-80.4C170.41,-87.13 203.98,-95.37 228.97,-101.51"/>
<polygon fill="#000000" stroke="#000000" points="228.22,-104.93 238.76,-103.92 229.89,-98.13 228.22,-104.93"/>
</g>
<!-- proc~tem_baryofid -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node3" class="node">
<title>proc~tem_baryofid</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node3"><a xlink:href="../proc/tem_baryofid.html" xlink:title="tem_BaryOfId">
<polygon fill="#d94e8f" stroke="#d94e8f" points="308.5,-80.36 223.5,-80.36 223.5,-56.36 308.5,-56.36 308.5,-80.36"/>
<text text-anchor="middle" x="266" y="-65.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_BaryOfId</text>
</a>
</g>
</g>
<!-- proc~tem_shape_findelembybclabels&#45;&gt;proc~tem_baryofid -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge2" class="edge">
<title>proc~tem_shape_findelembybclabels&#45;&gt;proc~tem_baryofid</title>
<path fill="none" stroke="#000000" d="M186.01,-68.36C195.22,-68.36 204.34,-68.36 212.92,-68.36"/>
<polygon fill="#000000" stroke="#000000" points="213.1,-71.86 223.1,-68.36 213.1,-64.86 213.1,-71.86"/>
</g>
<!-- proc~tem_elemsize -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node4" class="node">
<title>proc~tem_elemsize</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node4"><a xlink:href="../proc/tem_elemsize.html" xlink:title="tem_ElemSize">
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-38.36 222,-38.36 222,-14.36 310,-14.36 310,-38.36"/>
<text text-anchor="middle" x="266" y="-23.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_ElemSize</text>
</a>
</g>
</g>
<!-- proc~tem_shape_findelembybclabels&#45;&gt;proc~tem_elemsize -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge3" class="edge">
<title>proc~tem_shape_findelembybclabels&#45;&gt;proc~tem_elemsize</title>
<path fill="none" stroke="#000000" d="M143,-56.33C164.57,-51.03 189.95,-44.79 211.96,-39.39"/>
<polygon fill="#000000" stroke="#000000" points="212.94,-42.75 221.81,-36.97 211.27,-35.96 212.94,-42.75"/>
</g>
<!-- proc~append_da_label -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node5" class="node">
<title>proc~append_da_label</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node5"><a xlink:href="../proc/append_da_label.html" xlink:title="append_da_label">
<polygon fill="#d9534f" stroke="#d9534f" points="458.5,-122.36 355.5,-122.36 355.5,-98.36 458.5,-98.36 458.5,-122.36"/>
<text text-anchor="middle" x="407" y="-107.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append_da_label</text>
</a>
</g>
</g>
<!-- interface~append~19&#45;&gt;proc~append_da_label -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge4" class="edge">
<title>interface~append~19&#45;&gt;proc~append_da_label</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M293.14,-110.36C307.94,-110.36 327.1,-110.36 345.43,-110.36"/>
<polygon fill="#000000" stroke="#000000" points="345.48,-113.86 355.48,-110.36 345.48,-106.86 345.48,-113.86"/>
</g>
<!-- proc~append_da_veclabel -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node6" class="node">
<title>proc~append_da_veclabel</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node6"><a xlink:href="../proc/append_da_veclabel.html" xlink:title="append_da_veclabel">
<polygon fill="#d9534f" stroke="#d9534f" points="468,-164.36 346,-164.36 346,-140.36 468,-140.36 468,-164.36"/>
<text text-anchor="middle" x="407" y="-149.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append_da_veclabel</text>
</a>
</g>
</g>
<!-- interface~append~19&#45;&gt;proc~append_da_veclabel -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge5" class="edge">
<title>interface~append~19&#45;&gt;proc~append_da_veclabel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M293.14,-118.26C310.94,-123.64 335.06,-130.93 356.43,-137.38"/>
<polygon fill="#000000" stroke="#000000" points="355.44,-140.74 366.02,-140.28 357.46,-134.04 355.44,-140.74"/>
</g>
<!-- proc~tem_coordofid -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node7" class="node">
<title>proc~tem_coordofid</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node7"><a xlink:href="../proc/tem_coordofid.html" xlink:title="tem_CoordOfId">
<polygon fill="#d94e8f" stroke="#d94e8f" points="453.5,-80.36 360.5,-80.36 360.5,-56.36 453.5,-56.36 453.5,-80.36"/>
<text text-anchor="middle" x="407" y="-65.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_CoordOfId</text>
</a>
</g>
</g>
<!-- proc~tem_baryofid&#45;&gt;proc~tem_coordofid -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge6" class="edge">
<title>proc~tem_baryofid&#45;&gt;proc~tem_coordofid</title>
<path fill="none" stroke="#000000" d="M308.7,-68.36C321.7,-68.36 336.26,-68.36 350.07,-68.36"/>
<polygon fill="#000000" stroke="#000000" points="350.44,-71.86 360.44,-68.36 350.44,-64.86 350.44,-71.86"/>
</g>
<!-- proc~tem_elemsizelevel -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node8" class="node">
<title>proc~tem_elemsizelevel</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node8"><a xlink:href="../proc/tem_elemsizelevel.html" xlink:title="tem_ElemSizeLevel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="465,-38.36 349,-38.36 349,-14.36 465,-14.36 465,-38.36"/>
<text text-anchor="middle" x="407" y="-23.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_ElemSizeLevel</text>
</a>
</g>
</g>
<!-- proc~tem_baryofid&#45;&gt;proc~tem_elemsizelevel -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge7" class="edge">
<title>proc~tem_baryofid&#45;&gt;proc~tem_elemsizelevel</title>
<path fill="none" stroke="#000000" d="M306.83,-56.33C322.24,-51.67 340.05,-46.29 356.29,-41.38"/>
<polygon fill="#000000" stroke="#000000" points="357.6,-44.64 366.16,-38.4 355.58,-37.94 357.6,-44.64"/>
</g>
<!-- proc~tem_elemsize&#45;&gt;proc~tem_elemsizelevel -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge8" class="edge">
<title>proc~tem_elemsize&#45;&gt;proc~tem_elemsizelevel</title>
<path fill="none" stroke="#000000" d="M310.22,-26.36C319.27,-26.36 329.02,-26.36 338.7,-26.36"/>
<polygon fill="#000000" stroke="#000000" points="338.75,-29.86 348.75,-26.36 338.75,-22.86 338.75,-29.86"/>
</g>
<!-- proc~tem_levelof -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node9" class="node">
<title>proc~tem_levelof</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node9"><a xlink:href="../proc/tem_levelof.html" xlink:title="tem_LevelOf">
<polygon fill="#d94e8f" stroke="#d94e8f" points="589,-39.36 510,-39.36 510,-15.36 589,-15.36 589,-39.36"/>
<text text-anchor="middle" x="549.5" y="-24.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_LevelOf</text>
</a>
</g>
</g>
<!-- proc~tem_elemsize&#45;&gt;proc~tem_levelof -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge9" class="edge">
<title>proc~tem_elemsize&#45;&gt;proc~tem_levelof</title>
<path fill="none" stroke="#000000" d="M304.37,-14.3C317.4,-10.66 332.21,-7.16 346,-5.36 399.77,1.66 414.26,1.85 468,-5.36 479.44,-6.9 491.55,-9.61 502.82,-12.61"/>
<polygon fill="#000000" stroke="#000000" points="501.88,-15.99 512.46,-15.31 503.77,-9.24 501.88,-15.99"/>
</g>
<!-- interface~expand~19 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node10" class="node">
<title>interface~expand~19</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node10"><a xlink:href="../interface/expand~19.html" xlink:title="expand">
<polygon fill="#a7506f" stroke="#a7506f" points="576.5,-164.36 522.5,-164.36 522.5,-140.36 576.5,-140.36 576.5,-164.36"/>
<text text-anchor="middle" x="549.5" y="-149.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">expand</text>
</a>
</g>
</g>
<!-- proc~append_da_label&#45;&gt;interface~expand~19 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge10" class="edge">
<title>proc~append_da_label&#45;&gt;interface~expand~19</title>
<path fill="none" stroke="#000000" d="M448.26,-122.4C468.56,-128.47 492.98,-135.76 512.63,-141.64"/>
<polygon fill="#000000" stroke="#000000" points="511.84,-145.06 522.42,-144.57 513.85,-138.35 511.84,-145.06"/>
</g>
<!-- interface~sortedposofval~4 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node11" class="node">
<title>interface~sortedposofval~4</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node11"><a xlink:href="../interface/sortedposofval~4.html" xlink:title="sortedposofval">
<polygon fill="#a7506f" stroke="#a7506f" points="595,-122.36 504,-122.36 504,-98.36 595,-98.36 595,-122.36"/>
<text text-anchor="middle" x="549.5" y="-107.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sortedposofval</text>
</a>
</g>
</g>
<!-- proc~append_da_label&#45;&gt;interface~sortedposofval~4 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge11" class="edge">
<title>proc~append_da_label&#45;&gt;interface~sortedposofval~4</title>
<path fill="none" stroke="#000000" d="M458.72,-110.36C470.04,-110.36 482.09,-110.36 493.56,-110.36"/>
<polygon fill="#000000" stroke="#000000" points="493.9,-113.86 503.9,-110.36 493.9,-106.86 493.9,-113.86"/>
</g>
<!-- proc~append_da_veclabel&#45;&gt;interface~expand~19 -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge12" class="edge">
<title>proc~append_da_veclabel&#45;&gt;interface~expand~19</title>
<path fill="none" stroke="#000000" d="M468.4,-152.36C483.31,-152.36 498.82,-152.36 512.17,-152.36"/>
<polygon fill="#000000" stroke="#000000" points="512.37,-155.86 522.37,-152.36 512.37,-148.86 512.37,-155.86"/>
</g>
<!-- proc~tem_coordofid&#45;&gt;proc~tem_levelof -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge13" class="edge">
<title>proc~tem_coordofid&#45;&gt;proc~tem_levelof</title>
<path fill="none" stroke="#000000" d="M449.39,-56.28C465.21,-51.67 483.4,-46.36 499.83,-41.56"/>
<polygon fill="#000000" stroke="#000000" points="501.19,-44.81 509.81,-38.65 499.23,-38.09 501.19,-44.81"/>
</g>
<!-- proc~expand_da_label -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node12" class="node">
<title>proc~expand_da_label</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node12"><a xlink:href="../proc/expand_da_label.html" xlink:title="expand_da_label">
<polygon fill="#d9534f" stroke="#d9534f" points="736.5,-164.36 634.5,-164.36 634.5,-140.36 736.5,-140.36 736.5,-164.36"/>
<text text-anchor="middle" x="685.5" y="-149.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">expand_da_label</text>
</a>
</g>
</g>
<!-- interface~expand~19&#45;&gt;proc~expand_da_label -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge14" class="edge">
<title>interface~expand~19&#45;&gt;proc~expand_da_label</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M576.65,-152.36C590.22,-152.36 607.39,-152.36 624.02,-152.36"/>
<polygon fill="#000000" stroke="#000000" points="624.26,-155.86 634.26,-152.36 624.26,-148.86 624.26,-155.86"/>
</g>
<!-- proc~sortposofval_label -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_node13" class="node">
<title>proc~sortposofval_label</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CallsGraph_node13"><a xlink:href="../proc/sortposofval_label.html" xlink:title="sortposofval_label">
<polygon fill="#d94e8f" stroke="#d94e8f" points="740,-122.36 631,-122.36 631,-98.36 740,-98.36 740,-122.36"/>
<text text-anchor="middle" x="685.5" y="-107.96" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sortposofval_label</text>
</a>
</g>
</g>
<!-- interface~sortedposofval~4&#45;&gt;proc~sortposofval_label -->
<g id="proc~~tem_shape_findelembybclabels~~CallsGraph_edge15" class="edge">
<title>interface~sortedposofval~4&#45;&gt;proc~sortposofval_label</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M595.12,-110.36C603.33,-110.36 612.04,-110.36 620.69,-110.36"/>
<polygon fill="#000000" stroke="#000000" points="620.77,-113.86 630.77,-110.36 620.77,-106.86 620.77,-113.86"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproctem_shape_findelembybclabelsCallsGraph = svgPanZoom('#proctem_shape_findelembybclabelsCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~tem_shape_findelembybclabels~~CalledByGraph Pages: 1 -->
<svg id="proctem_shape_findelembybclabelsCalledByGraph" width="641pt" height="136pt"
 viewBox="0.00 0.00 641.00 136.31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 154)">
<title>proc~~tem_shape_findelembybclabels~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-154 739,-154 739,4 -4,4"/>
<!-- proc~tem_shape_findelembybclabels -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node1" class="node">
<title>proc~tem_shape_findelembybclabels</title>
<polygon fill="none" stroke="black" points="735,-87 549,-87 549,-63 735,-63 735,-87"/>
<text text-anchor="middle" x="642" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50">tem_shape_findElemByBCLabels</text>
</g>
<!-- proc~tem_shape2subtree -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node2" class="node">
<title>proc~tem_shape2subtree</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CalledByGraph_node2"><a xlink:href="../proc/tem_shape2subtree.html" xlink:title="tem_shape2subTree">
<polygon fill="#d9534f" stroke="#d9534f" points="513,-87 395,-87 395,-63 513,-63 513,-87"/>
<text text-anchor="middle" x="454" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_shape2subTree</text>
</a>
</g>
</g>
<!-- proc~tem_shape2subtree&#45;&gt;proc~tem_shape_findelembybclabels -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_edge1" class="edge">
<title>proc~tem_shape2subtree&#45;&gt;proc~tem_shape_findelembybclabels</title>
<path fill="none" stroke="#000000" d="M513.09,-75C521.28,-75 529.9,-75 538.64,-75"/>
<polygon fill="#000000" stroke="#000000" points="538.92,-78.5 548.92,-75 538.92,-71.5 538.92,-78.5"/>
</g>
<!-- proc~tem_create_subtree_of -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node3" class="node">
<title>proc~tem_create_subtree_of</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CalledByGraph_node3"><a xlink:href="../proc/tem_create_subtree_of.html" xlink:title="tem_create_subTree_of">
<polygon fill="#d9534f" stroke="#d9534f" points="359,-87 225,-87 225,-63 359,-63 359,-87"/>
<text text-anchor="middle" x="292" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_create_subTree_of</text>
</a>
</g>
</g>
<!-- proc~tem_create_subtree_of&#45;&gt;proc~tem_shape2subtree -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_edge2" class="edge">
<title>proc~tem_create_subtree_of&#45;&gt;proc~tem_shape2subtree</title>
<path fill="none" stroke="#000000" d="M359,-75C367.45,-75 376.11,-75 384.59,-75"/>
<polygon fill="#000000" stroke="#000000" points="384.82,-78.5 394.82,-75 384.82,-71.5 384.82,-78.5"/>
</g>
<!-- proc~tem_create_subtree_of_st_funlist -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node4" class="node">
<title>proc~tem_create_subtree_of_st_funlist</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CalledByGraph_node4"><a xlink:href="../proc/tem_create_subtree_of_st_funlist.html" xlink:title="tem_create_subTree_of_st_funList">
<polygon fill="#d9534f" stroke="#d9534f" points="189,-150 0,-150 0,-126 189,-126 189,-150"/>
<text text-anchor="middle" x="94.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_create_subTree_of_st_funList</text>
</a>
</g>
</g>
<!-- proc~tem_create_subtree_of_st_funlist&#45;&gt;proc~tem_create_subtree_of -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_edge3" class="edge">
<title>proc~tem_create_subtree_of_st_funlist&#45;&gt;proc~tem_create_subtree_of</title>
<path fill="none" stroke="#000000" d="M156.26,-125.93C167.24,-123.3 178.53,-120.31 189,-117 211.65,-109.85 236.3,-99.77 255.69,-91.27"/>
<polygon fill="#000000" stroke="#000000" points="257.32,-94.38 265.04,-87.13 254.48,-87.98 257.32,-94.38"/>
</g>
<!-- proc~tem_init_convergence -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node5" class="node">
<title>proc~tem_init_convergence</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CalledByGraph_node5"><a xlink:href="../proc/tem_init_convergence.html" xlink:title="tem_init_convergence">
<polygon fill="#d9534f" stroke="#d9534f" points="159.5,-108 29.5,-108 29.5,-84 159.5,-84 159.5,-108"/>
<text text-anchor="middle" x="94.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_init_convergence</text>
</a>
</g>
</g>
<!-- proc~tem_init_convergence&#45;&gt;proc~tem_create_subtree_of -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_edge4" class="edge">
<title>proc~tem_init_convergence&#45;&gt;proc~tem_create_subtree_of</title>
<path fill="none" stroke="#000000" d="M159.51,-89.12C177.18,-87.23 196.52,-85.15 214.8,-83.19"/>
<polygon fill="#000000" stroke="#000000" points="215.26,-86.66 224.83,-82.11 214.51,-79.7 215.26,-86.66"/>
</g>
<!-- proc~tem_init_tracker_subtree -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node6" class="node">
<title>proc~tem_init_tracker_subtree</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CalledByGraph_node6"><a xlink:href="../proc/tem_init_tracker_subtree.html" xlink:title="tem_init_tracker_subTree">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-66 22,-66 22,-42 167,-42 167,-66"/>
<text text-anchor="middle" x="94.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_init_tracker_subTree</text>
</a>
</g>
</g>
<!-- proc~tem_init_tracker_subtree&#45;&gt;proc~tem_create_subtree_of -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_edge5" class="edge">
<title>proc~tem_init_tracker_subtree&#45;&gt;proc~tem_create_subtree_of</title>
<path fill="none" stroke="#000000" d="M167.19,-61.7C182.65,-63.36 199.06,-65.12 214.69,-66.8"/>
<polygon fill="#000000" stroke="#000000" points="214.52,-70.3 224.84,-67.89 215.27,-63.34 214.52,-70.3"/>
</g>
<!-- proc~tem_write_debugmesh -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_node7" class="node">
<title>proc~tem_write_debugmesh</title>
<g id="a_proc~~tem_shape_findelembybclabels~~CalledByGraph_node7"><a xlink:href="../proc/tem_write_debugmesh.html" xlink:title="tem_write_debugMesh">
<polygon fill="#d9534f" stroke="#d9534f" points="160.5,-24 28.5,-24 28.5,0 160.5,0 160.5,-24"/>
<text text-anchor="middle" x="94.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tem_write_debugMesh</text>
</a>
</g>
</g>
<!-- proc~tem_write_debugmesh&#45;&gt;proc~tem_create_subtree_of -->
<g id="proc~~tem_shape_findelembybclabels~~CalledByGraph_edge6" class="edge">
<title>proc~tem_write_debugmesh&#45;&gt;proc~tem_create_subtree_of</title>
<path fill="none" stroke="#000000" d="M156.26,-24.07C167.24,-26.7 178.53,-29.69 189,-33 211.65,-40.15 236.3,-50.23 255.69,-58.73"/>
<polygon fill="#000000" stroke="#000000" points="254.48,-62.02 265.04,-62.87 257.32,-55.62 254.48,-62.02"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproctem_shape_findelembybclabelsCalledByGraph = svgPanZoom('#proctem_shape_findelembybclabelsCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">tem_shape_findElemByBCLabels</span><span class="p">(</span><span class="w"> </span><span class="n">bcLabels</span><span class="p">,</span><span class="w"> </span><span class="n">cutOffQVal</span><span class="p">,</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">    </span><span class="p">&amp;</span><span class="w">                                      </span><span class="n">foundAny</span><span class="p">,</span><span class="w"> </span><span class="n">map2global</span><span class="p">,</span><span class="w"> </span><span class="n">inTree</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span>
<span class="w">    </span><span class="p">&amp;</span><span class="w">                                      </span><span class="n">countPoints</span><span class="p">,</span><span class="w"> </span><span class="n">grwPnts</span><span class="p">,</span><span class="w"> </span><span class="n">storePnts</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">    </span><span class="p">&amp;</span><span class="w">                                      </span><span class="n">bcIDs</span><span class="p">,</span><span class="w"> </span><span class="n">stencil</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="c">! --------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">!&gt; bcLabels</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">labelLen</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bcLabels</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&gt; Cut off qValue</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">rk</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cutOffQVal</span>
<span class="w">    </span><span class="c">!&gt; bc property</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_bc_prop_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bc_prop</span>
<span class="w">    </span><span class="c">!&gt; if any element be identified</span>
<span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w">                 </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">foundAny</span>
<span class="w">    </span><span class="c">!&gt; dynamic array. Elements positions in bc_prop%property%elemID</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dyn_intArray_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">map2global</span>
<span class="w">    </span><span class="c">!&gt; Global tree</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">treelmesh_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inTree</span>
<span class="w">    </span><span class="c">!&gt; How many points there will be</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="w"> </span><span class="n">inout</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">countPoints</span>
<span class="w">    </span><span class="c">!&gt; growing array to store tracking points</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_grwPoints_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grwPnts</span>
<span class="w">    </span><span class="c">!&gt; to Store points in grwPnts</span>
<span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">storePnts</span>
<span class="w">    </span><span class="c">!&gt; id of boundary condition to be tracked</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bcIDs</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&gt; stencil required to get useful links</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="w"> </span><span class="n">tem_stencilHeader_type</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">stencil</span>
<span class="w">    </span><span class="c">! --------------------------------------------------------------------------</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dPos</span><span class="p">,</span><span class="w"> </span><span class="n">iElem</span><span class="p">,</span><span class="w"> </span><span class="n">iBC</span><span class="p">,</span><span class="w"> </span><span class="n">nBCs</span><span class="p">,</span><span class="w"> </span><span class="n">iBCtype</span><span class="p">,</span><span class="w"> </span><span class="n">posInTree</span><span class="p">,</span><span class="w"> </span><span class="n">QQN</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wasAdded</span><span class="p">,</span><span class="w"> </span><span class="n">found</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">map</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">rk</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">qValWeight</span><span class="p">(:),</span><span class="w"> </span><span class="n">weightedQVal</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">rk</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">bary</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">point</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">minQVal</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iDir</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">iElem_qVal</span><span class="p">,</span><span class="w"> </span><span class="n">minQValiDir</span>
<span class="w">    </span><span class="c">! --------------------------------------------------------------------------</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="w"> </span><span class="n">stencil</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      allocate</span><span class="p">(</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">stencil</span><span class="p">%</span><span class="n">map</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="p">%</span><span class="n">map</span>
<span class="w">      </span><span class="n">qqn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="p">%</span><span class="n">QQN</span>
<span class="w">    </span><span class="k">else</span>
<span class="k">      allocate</span><span class="p">(</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="n">qQQQ</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qDir</span>
<span class="w">      </span><span class="n">qqn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qQQQ</span>
<span class="w">    </span><span class="k">end if</span>

<span class="w">    </span><span class="c">! calculate weights on qValue for each direction. </span>
<span class="w">    </span><span class="c">! It depends on the link length.</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">weightedQVal</span><span class="p">(</span><span class="n">qqn</span><span class="p">))</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">qValWeight</span><span class="p">(</span><span class="n">qqn</span><span class="p">))</span>
<span class="w">    </span><span class="k">do </span><span class="n">iDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">qqn</span>
<span class="w">      </span><span class="n">length</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">qOffset</span><span class="p">(</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="n">iDir</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">      </span><span class="o">+</span><span class="w"> </span><span class="n">qOffset</span><span class="p">(</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="n">iDir</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="p">&amp;</span><span class="w">      </span><span class="o">+</span><span class="w"> </span><span class="n">qOffset</span><span class="p">(</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="n">iDir</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="w">      </span><span class="n">qValWeight</span><span class="p">(</span><span class="n">iDir</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="nb">kind</span><span class="o">=</span><span class="n">rk</span><span class="p">))</span>
<span class="w">    </span><span class="k">end do</span>

<span class="k">    </span><span class="n">foundAny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="c">! convert bcLabels to bcIDs</span>
<span class="w">    </span><span class="n">nBCs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">bcLabels</span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">bcIDs</span><span class="p">(</span><span class="w"> </span><span class="n">nBCs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="c">! loop over all required bcLabels</span>
<span class="w">    </span><span class="k">do </span><span class="n">iBC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nBCs</span>

<span class="w">      </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>

<span class="w">      </span><span class="c">! loop over all BCs in the mesh</span>
<span class="w">      </span><span class="k">do </span><span class="n">iBCtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">%</span><span class="n">nBCtypes</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">bcLabels</span><span class="p">(</span><span class="n">iBC</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">%</span><span class="n">bc_label</span><span class="p">(</span><span class="w"> </span><span class="n">iBCtype</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">bcIDs</span><span class="p">(</span><span class="w"> </span><span class="n">iBC</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iBCtype</span>
<span class="w">          </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">          </span><span class="k">exit</span>
<span class="k">        end if</span>
<span class="k">      end do</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="n">logUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Required BC label: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">bcLabels</span><span class="p">(</span><span class="n">iBC</span><span class="p">))</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">logUnit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;can not be found in given mesh!&#39;</span>
<span class="w">        </span><span class="k">stop</span>
<span class="k">      end if</span>
<span class="k">    end do</span><span class="w"> </span><span class="c">! iBC</span>

<span class="w">    </span><span class="n">iElem_qVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="c">! Loop over all element with boundary property</span>
<span class="w">    </span><span class="k">do </span><span class="n">iElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">%</span><span class="n">property</span><span class="p">%</span><span class="n">nElems</span>
<span class="w">      </span><span class="n">posInTree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">%</span><span class="n">property</span><span class="p">%</span><span class="n">elemID</span><span class="p">(</span><span class="n">iElem</span><span class="p">)</span>
<span class="w">      </span><span class="c">! Count the elem with qVal property to access the qVal from</span>
<span class="w">      </span><span class="c">! bc_prop%qVal</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">btest</span><span class="p">(</span><span class="w"> </span><span class="n">inTree</span><span class="p">%</span><span class="n">elemPropertyBits</span><span class="p">(</span><span class="w"> </span><span class="n">posInTree</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">prp_hasQVal</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">iElem_qVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iElem_qVal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      do </span><span class="n">iBC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nBCs</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bc_prop</span><span class="p">%</span><span class="n">boundary_ID</span><span class="p">(</span><span class="w"> </span><span class="n">map</span><span class="p">(:</span><span class="n">qqn</span><span class="p">),</span><span class="w"> </span><span class="n">iElem</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bcIDs</span><span class="p">(</span><span class="n">iBC</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">          </span><span class="c">! If element has qValues then consider element which satisfy</span>
<span class="w">          </span><span class="c">! cutOffQVal</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">btest</span><span class="p">(</span><span class="n">inTree</span><span class="p">%</span><span class="n">ElemPropertyBits</span><span class="p">(</span><span class="n">posInTree</span><span class="p">),</span><span class="w"> </span><span class="n">prp_hasQVal</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            do </span><span class="n">iDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">qqn</span>
<span class="w">              </span><span class="n">weightedQVal</span><span class="p">(</span><span class="n">iDir</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qValWeight</span><span class="p">(</span><span class="n">iDir</span><span class="p">)</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">                </span><span class="p">&amp;</span><span class="w">                </span><span class="o">*</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">%</span><span class="n">qVal</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">iDir</span><span class="p">),</span><span class="w"> </span><span class="n">iElem_qVal</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            </span><span class="n">minQValiDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">minloc</span><span class="p">(</span><span class="n">weightedQVal</span><span class="p">,</span><span class="w"> </span><span class="nb">DIM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MASK</span><span class="o">=</span><span class="p">(</span><span class="n">weightedQVal</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span>
<span class="w">            </span><span class="n">minQVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bc_prop</span><span class="p">%</span><span class="n">qVal</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">minQValiDir</span><span class="p">),</span><span class="w"> </span><span class="n">iElem_qVal</span><span class="p">)</span>
<span class="w">          </span><span class="k">else</span>
<span class="k">            </span><span class="n">minQVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutOffQVal</span>
<span class="w">          </span><span class="k">end if</span>

<span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="n">minQVal</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">cutOffQVal</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">            </span><span class="c">! Append to treeID list (note that already existing ones are</span>
<span class="w">            </span><span class="c">! omitted)</span>
<span class="w">            </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">map2global</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">          </span><span class="n">pos</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">dPos</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">posInTree</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">              </span><span class="p">&amp;</span><span class="w">          </span><span class="n">wasAdded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasAdded</span><span class="w"> </span><span class="p">)</span>

<span class="w">            </span><span class="c">! Count up if it was added</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">wasAdded</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! tLevel = tem_levelOf( inTree%treeID(posInTree) )</span>
<span class="w">              </span><span class="c">! countElems( tLevel ) = countElems( tLevel ) + 1</span>
<span class="w">              </span><span class="n">foundAny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>

<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">storePnts</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! Create growing array of points for boundary elements with </span>
<span class="w">                </span><span class="c">! qValues.</span>
<span class="w">                </span><span class="c">! Point is created along minimum qValue direction.</span>
<span class="w">                </span><span class="n">bary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tem_BaryOfId</span><span class="p">(</span><span class="w"> </span><span class="n">inTree</span><span class="p">,</span><span class="w"> </span><span class="n">inTree</span><span class="p">%</span><span class="n">treeID</span><span class="p">(</span><span class="n">posInTree</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">btest</span><span class="p">(</span><span class="n">inTree</span><span class="p">%</span><span class="n">ElemPropertyBits</span><span class="p">(</span><span class="n">posInTree</span><span class="p">),</span><span class="w"> </span><span class="n">prp_hasQVal</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tem_ElemSize</span><span class="p">(</span><span class="w"> </span><span class="n">inTree</span><span class="p">,</span><span class="w"> </span><span class="n">inTree</span><span class="p">%</span><span class="n">treeID</span><span class="p">(</span><span class="n">posInTree</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="w">                  </span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bary</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qOffset</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">minQValiDir</span><span class="p">),</span><span class="w"> </span><span class="p">:)</span>
<span class="w">                  </span><span class="c">! append the physical points to the growing array of points</span>
<span class="w">                  </span><span class="k">call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">grwPnts</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">point</span><span class="w">    </span><span class="p">)</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                  call </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">grwPnts</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="p">&amp;</span><span class="w">          </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bary</span><span class="w">     </span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                </span><span class="n">countPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countPoints</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">            end if</span><span class="w"> </span><span class="c">!storePnts</span>

<span class="w">            </span><span class="k">exit</span><span class="w"> </span><span class="c">! continue with next element</span>
<span class="w">          </span><span class="k">end if</span><span class="w"> </span><span class="c">! wasAdded</span>

<span class="w">        </span><span class="k">end if</span><span class="w"> </span><span class="c">! boundary_ID == bcIDs</span>
<span class="w">      </span><span class="k">end do</span>

<span class="k">    end do</span><span class="w"> </span><span class="c">! iElem</span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">tem_shape_findElemByBCLabels</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Treelm
 was developed by University of Siegen<br>              &copy; 2024 
<br /><small>1f5a31ff05d4</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-11-09T16:45:01.240943             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>