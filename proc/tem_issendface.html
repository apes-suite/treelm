<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Tree based Elemental Mesh">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>tem_isSendFace &ndash; Treelm</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Treelm </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">TreElm Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tem_isSendFace
      <small>Function</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.3% of total for procedures.">114 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tem_face_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tem_face_module.f90.html'>tem_face_module.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/tem_face_module.html'>tem_face_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">tem_isSendFace</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/tem_issendface.html#src">tem_isSendFace</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private pure function tem_isSendFace(facePos, faces) result(isSendFace)  
</h2>
    

    <p>for the a given face before the compute step.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-facepos~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>facePos</strong></td>
            <td>
                <p>The position of the face in faces to be checked.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-faces~7"></span>
              type(<a href='../type/tem_face_descriptor_type.html'>tem_face_descriptor_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>faces</strong></td>
            <td>
                <p>The description of the faces.</p>
            </td>
        </tr>
    </tbody>
  </table>

      <h3>Return Value
        <small>
          <span class="anchor" id="variable-issendface"></span>
          integer
        </small>
      </h3>
      <p>Returns 0 if no information has to be received from remote ranks
before a compute step can be done. In case that information has to be
received it will return a non-zero positive value. Furhtermore,
it determines whether information for the left face value
(left adjacent element)
or the right face value (right adjacent element) has to be received.
In the first case it will return
<a href="../module/tem_facedata_module.html#variable-tem_left">tem_left</a> and in the second case
it will return
<a href="../module/tem_facedata_module.html#variable-tem_right">tem_right</a>.
If something went wrong, e.g. an unknown combination occurs,
it will return -1.</p>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">pure function </span><span class="n">tem_isSendFace</span><span class="p">(</span><span class="n">facePos</span><span class="p">,</span><span class="w"> </span><span class="n">faces</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="w"> </span><span class="n">isSendFace</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="c">! --------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">!&gt; The position of the face in faces to be checked.</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">facePos</span>
<span class="w">    </span><span class="c">!&gt; The description of the faces.</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_face_descriptor_type</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">faces</span>
<span class="w">    </span><span class="c">!&gt; Returns 0 if no information has to be received from remote ranks</span>
<span class="w">    </span><span class="c">!! before a compute step can be done. In case that information has to be</span>
<span class="w">    </span><span class="c">!! received it will return a non-zero positive value. Furhtermore,</span>
<span class="w">    </span><span class="c">!! it determines whether information for the left face value</span>
<span class="w">    </span><span class="c">!! (left adjacent element)</span>
<span class="w">    </span><span class="c">!! or the right face value (right adjacent element) has to be received.</span>
<span class="w">    </span><span class="c">!! In the first case it will return</span>
<span class="w">    </span><span class="c">!! [[tem_faceData_module:tem_left]] and in the second case</span>
<span class="w">    </span><span class="c">!! it will return</span>
<span class="w">    </span><span class="c">!! [[tem_faceData_module:tem_right]].</span>
<span class="w">    </span><span class="c">!! If something went wrong, e.g. an unknown combination occurs,</span>
<span class="w">    </span><span class="c">!! it will return -1.</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isSendFace</span>
<span class="w">    </span><span class="c">! --------------------------------------------------------------------------</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">,</span><span class="w"> </span><span class="n">rightPrp</span>
<span class="w">    </span><span class="c">! --------------------------------------------------------------------------</span>

<span class="w">    </span><span class="n">leftPrp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">faces</span><span class="p">%</span><span class="n">faceList</span><span class="p">%</span><span class="n">leftPrp</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">facePos</span><span class="p">)</span>
<span class="w">    </span><span class="n">rightPrp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">faces</span><span class="p">%</span><span class="n">faceList</span><span class="p">%</span><span class="n">rightPrp</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">facePos</span><span class="p">)</span>

<span class="w">    </span><span class="n">issendface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="c">! default value (error)</span>

<span class="w">    </span><span class="c">! So, check for all conditions under which face info has to be send.</span>

<span class="w">    </span><span class="c">! Fluid-fluid face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; nothing to send</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! Fluid-remote face (the halo is not refined)</span>
<span class="w">    </span><span class="c">! -&gt; left element is on my rank, so I will compute it. Therefore, I will</span>
<span class="w">    </span><span class="c">!    receive information about the right element, but I do not have to send</span>
<span class="w">    </span><span class="c">!    anything.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! Remote-fluid face (the halo is not refined)</span>
<span class="w">    </span><span class="c">! -&gt; left element is on a remote rank, so I will not compute it. Therfore</span>
<span class="w">    </span><span class="c">!    I will send the element to the remote rank.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tem_right</span>

<span class="w">    </span><span class="c">! Remote-notExisting face (the remote is not refined)</span>
<span class="w">    </span><span class="c">! -&gt; remote is not located on my rank and the other element does not</span>
<span class="w">    </span><span class="c">!    exist. This face does not have to be computed on any rank, so my rank</span>
<span class="w">    </span><span class="c">!    is not sending any info about any element adjacent to this face.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! notExisting-remote face (the remote is not refined)</span>
<span class="w">    </span><span class="c">! -&gt; remote is not located on my rank and the other element does not</span>
<span class="w">    </span><span class="c">!    exist. This face does not have to be computed on any rank, so my rank</span>
<span class="w">    </span><span class="c">!    is not send any info about any element adjacent to this face.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! Fluid-fromFiner face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; everything is local, so there is no need to send or recv information</span>
<span class="w">    </span><span class="c">!    from another rank.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! FromFiner-fluid face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; everything is local, so there is no need to send or recv information</span>
<span class="w">    </span><span class="c">!    from another rank.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! FromFiner-FromFiner face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; everything is local. Somehow two ghost elements meet each other, but</span>
<span class="w">    </span><span class="c">!    we do not have to recv or send any data for these faces.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! FromCoarser-fluid face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; everything is local, so no data has to be send or received.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! Fluid-fromCoarser face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; everything is local, so no data has to be send or received.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! FromCoarser-fromCoarser face (purely local)</span>
<span class="w">    </span><span class="c">! -&gt; everything is local, so no data has to be send or received.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! Remote-fromCoarser face</span>
<span class="w">    </span><span class="c">! -&gt; The remote fluid elements are located on a finer level</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tem_right</span>

<span class="w">    </span><span class="c">! FromCoarser-remote face</span>
<span class="w">    </span><span class="c">! -&gt; The remote fluid elements are located on a finer level</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tem_left</span>

<span class="w">    </span><span class="c">! Remote-remote face</span>
<span class="w">    </span><span class="c">! -&gt; The halo elements meet each other. This can happen, but we do not have</span>
<span class="w">    </span><span class="c">!    to send or receive information for this face, because we do not</span>
<span class="w">    </span><span class="c">!    compute anything here.</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! notExist - remote face (nothing to be send, we do not have info about</span>
<span class="w">    </span><span class="c">! adjacent elements)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote - notExist face (nothing to be send, we do not have any info about</span>
<span class="w">    </span><span class="c">! adjacent elements)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fluid-remote+fromCoaser face (here, we receive data in some situations,</span>
<span class="w">    </span><span class="c">! but we never send info in this case)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromCoarserFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromCoarser-fluid face (here, we receive data in some situations,</span>
<span class="w">    </span><span class="c">! but we never send info for this faces)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="n">tem_fromCoarserFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! notExist-remote+fromCoaser face (nothing to be send here)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromCoarserFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromCoarser-remote face (everything is remote, so nothing to be</span>
<span class="w">    </span><span class="c">! sent)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromCoarserFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromCoarser-remote+fromCoaser face (everything is remote, so</span>
<span class="w">    </span><span class="c">! nothing to be sent)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromCoarserFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromCoarserFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner - not exist face (nothing to be send here).</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! notExist - fromFiner face (nothing to be send here)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner+remote - fluid face (will be send on the finer level)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fluid - remote+fromFiner face (will be send on the finer level)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromCoarser - notExist face (nothing to send)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! notExist - fromCoarser face (nothing to send)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromFiner-remote face (everything is remote)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote-remote+fromFiner face (everything is remote)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                               </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromFinerFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! notExist-remote+fromFiner face (nothing is on my rank)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromFinerFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromFiner-notExist face (nothing is on my rank)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_remoteFace_prp</span><span class="p">,</span><span class="w"> </span><span class="n">tem_fromFinerFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_notExist_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner-fromCoarser face (everything is local, this is an intermediate</span>
<span class="w">    </span><span class="c">! face level (i.e. leveljumps of difference larger than 1 occure here) )</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromCoarser-fromFiner face (everything is local, this is an intermediate</span>
<span class="w">    </span><span class="c">! face level (i.e. leveljumps of difference larger than 1 occure here) )</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner+remote - fromCoarser face (send on a finer level)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromCoarser - remote+fromFiner face (send on a finer level)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromFiner - remote+fromFiner face (everything is remote, nothing</span>
<span class="w">    </span><span class="c">! to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromFiner - fromFiner face (everything is from finer, nothing to</span>
<span class="w">    </span><span class="c">! be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner - remote+fromFiner face (everything is from finer, nothing to</span>
<span class="w">    </span><span class="c">! be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner - remote face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote - fromFiner face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote+fromCoarser - fromCoarser face (elements are on coarser</span>
<span class="w">    </span><span class="c">! level, here and remote so nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromCoarserFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromCoarser - remote+fromCoarser face (elements are on coarser</span>
<span class="w">    </span><span class="c">! level, here and remote so nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromCoarserFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fluid - boundary face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! boundary - fluid face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fluidFace_prp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! remote - boundary face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! boundary - remote face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner - boundary face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! boundary - fromFiner face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                   </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromFinerFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromFiner+remote - boundary face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! boundary - fromFiner+remote face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                   </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="nb">ior</span><span class="p">(</span><span class="n">tem_fromFinerFace_prp</span><span class="p">,</span><span class="n">tem_remoteFace_prp</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! fromCoarser - boundary face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">! boundary - fromCoarser face (nothing to be done)</span>
<span class="w">    </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">leftPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_bndFace_prp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">                                   </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">     </span><span class="n">rightPrp</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">tem_fromCoarserFace_prp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">isSendFace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="k">end if</span>

<span class="k">  end function </span><span class="n">tem_isSendFace</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Treelm
 was developed by University of Siegen<br>              &copy; 2025 
<br /><small>9899d1376992</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-02T13:06:23.655310+0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>