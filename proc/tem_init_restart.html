<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Tree based Elemental Mesh">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>tem_init_restart &ndash; Treelm</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Treelm </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">TreElm Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tem_init_restart
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.2% of total for procedures.">54 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tem_restart_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tem_restart_module.f90.html'>tem_restart_module.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/tem_restart_module.html'>tem_restart_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">tem_init_restart</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/tem_init_restart.html#src">tem_init_restart</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine tem_init_restart(me, solver, varMap, tree, subTree, nDofs_write, chunkSize, solSpec_unit)  
</h2>
    

    <p>Initialize the global restart data type and prepare for the restart output</p>
<p>This routine is called as well for read as for write restart tasks
It must be called after <a href="../proc/tem_load_restart.html">tem_load_restart</a> and before the first call to
any of tem_restart_*
This routine is called only when restart is read from the restart table.
If restart is performed from the initial condition table, then
different routines (which are basically wrapped around by this one) are
invoked</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~634"></span>
              type(<a href='../type/tem_restart_type.html'>tem_restart_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>
                <p>The restart object to initialize.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solver~7"></span>
              type(<a href='../type/tem_solvehead_type.html'>tem_solveHead_type</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solver</strong></td>
            <td>
                <p>Details about the solver.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-varmap~6"></span>
              type(<a href='../type/tem_varmap_type.html'>tem_varMap_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>varMap</strong></td>
            <td>
                <p>Description of each variable system.
This is ignored, if the data is provided by reading
a restart.
Contains position of variables to dump in restart file in global
variable system for a scheme</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tree~153"></span>
              type(<a href='../type/treelmesh_type.html'>treelmesh_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tree</strong></td>
            <td>
                <p>Mesh, provided in treelm format</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-subtree~13"></span>
              type(<a href='../type/tem_subtree_type.html'>tem_subTree_type</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>subTree</strong></td>
            <td>
                <p>optional subTree of the given tree</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ndofs_write"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nDofs_write</strong></td>
            <td>
                <p>number of degrees of freedom for each variable of the equation system</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-chunksize~6"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>chunkSize</strong></td>
            <td>
                <p>use predefined chunkSize</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solspec_unit~4"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solSpec_unit</strong></td>
            <td>
                <p>Solver specific unit for restart header</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">tem_init_restart</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="p">,</span><span class="w"> </span><span class="n">solver</span><span class="p">,</span><span class="w"> </span><span class="n">varMap</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">subTree</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">    </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">nDofs_write</span><span class="p">,</span><span class="w"> </span><span class="n">chunkSize</span><span class="p">,</span><span class="w"> </span><span class="n">solSpec_unit</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="c">! -------------------------------------------------------------------- !</span>
<span class="w">    </span><span class="c">!&gt; The restart object to initialize.</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_restart_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span>
<span class="w">    </span><span class="c">!&gt; Details about the solver.</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_solveHead_type</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">solver</span>
<span class="w">    </span><span class="c">!&gt; Description of each variable system.</span>
<span class="w">    </span><span class="c">!! This is ignored, if the data is provided by reading</span>
<span class="w">    </span><span class="c">!! a restart.</span>
<span class="w">    </span><span class="c">! type(tem_varSys_type), intent(in)              :: varSys</span>
<span class="w">    </span><span class="c">!&gt; Contains position of variables to dump in restart file in global</span>
<span class="w">    </span><span class="c">!! variable system for a scheme</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_varMap_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">varMap</span>
<span class="w">    </span><span class="c">!&gt; Mesh, provided in treelm format</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">treelmesh_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">tree</span>
<span class="w">    </span><span class="c">!&gt; optional subTree of the given tree</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">tem_subTree_type</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">subTree</span>
<span class="w">    </span><span class="c">!&gt; number of degrees of freedom for each variable of the equation system</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">nDofs_write</span>
<span class="w">    </span><span class="c">!&gt; use predefined chunkSize</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">chunkSize</span>
<span class="w">    </span><span class="c">!&gt; Solver specific unit for restart header</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">solSpec_unit</span>
<span class="w">    </span><span class="c">! -------------------------------------------------------------------- !</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">comm_size</span><span class="p">,</span><span class="w"> </span><span class="n">locElems</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">long_k</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">globElems</span><span class="p">,</span><span class="w"> </span><span class="n">elemOff</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">read_stat</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nUnitOpened</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">320</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">solve_line</span>
<span class="w">    </span><span class="c">! -------------------------------------------------------------------- !</span>

<span class="w">    </span><span class="c">! set information about variables to be dumped in restart format.</span>
<span class="w">    </span><span class="c">! Do this irrespective of read or write restart</span>
<span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">varMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">varMap</span>

<span class="w">    </span><span class="c">! Get the total number of chunks necessary to write data-set through IO</span>
<span class="w">    </span><span class="c">! buffer to disk.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="w"> </span><span class="n">subTree</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">comm</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">subTree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">comm</span>
<span class="w">      </span><span class="n">rank</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">subTree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">myPart</span>
<span class="w">      </span><span class="n">comm_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subTree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">nParts</span>
<span class="w">      </span><span class="n">globElems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subTree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">nElems</span>
<span class="w">      </span><span class="n">elemOff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">subTree</span><span class="p">%</span><span class="n">elemOffset</span>
<span class="w">      </span><span class="n">locElems</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">subTree</span><span class="p">%</span><span class="n">nElems</span><span class="p">)</span>
<span class="w">    </span><span class="k">else</span>
<span class="k">      </span><span class="n">comm</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">comm</span>
<span class="w">      </span><span class="n">rank</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">myPart</span>
<span class="w">      </span><span class="n">comm_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">nParts</span>
<span class="w">      </span><span class="n">globElems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">%</span><span class="n">global</span><span class="p">%</span><span class="n">nElems</span>
<span class="w">      </span><span class="n">elemOff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">%</span><span class="n">elemOffset</span>
<span class="w">      </span><span class="n">locElems</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">tree</span><span class="p">%</span><span class="n">nElems</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>

<span class="w">    </span><span class="c">! Invoke the routine to allocate various variables</span>
<span class="w">    </span><span class="k">call </span><span class="n">tem_init_restart_alloc</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">comm</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">rank</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">comm_size</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">comm_size</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">solver</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">nDofs_write</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nDofs_write</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="c">! Loop over all the systems to create MPI types for reading restart</span>
<span class="w">    </span><span class="c">! Invoke the routine which creates MPI Types</span>
<span class="w">    </span><span class="k">call </span><span class="n">tem_init_restart_create_types</span><span class="p">(</span><span class="w"> </span><span class="n">me</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">elemOff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">elemOff</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">locElems</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">locElems</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">tem_restart_getTotalChunks</span><span class="p">(</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">nElems</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">locElems</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">comm</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">      </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">chunkSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">chunkSize</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="c">! In root of this restart type,</span>
<span class="w">    </span><span class="c">! if write restart is active and solSpec_unit is present</span>
<span class="w">    </span><span class="c">! and opened then copy the content in solSpec_unit to internal</span>
<span class="w">    </span><span class="c">! restart scratch unit</span>
<span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">solSpec_unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">controller</span><span class="p">%</span><span class="n">writeRestart</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">solSpec_unit</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">solSpec_unit</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Writing solver specific info in restart:&#39;</span>
<span class="w">          </span><span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">solSpec_unit</span><span class="p">,</span><span class="w"> </span><span class="n">opened</span><span class="o">=</span><span class="n">nUnitOpened</span><span class="p">)</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nUnitOpened</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">me</span><span class="p">%</span><span class="n">solSpec_unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newunit</span><span class="p">()</span>
<span class="w">            </span><span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">me</span><span class="p">%</span><span class="n">solSpec_unit</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;scratch&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">rewind</span><span class="p">(</span><span class="n">solSpec_unit</span><span class="p">)</span>
<span class="w">            </span><span class="k">do</span>
<span class="k">              read</span><span class="p">(</span><span class="n">solSpec_unit</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">read_stat</span><span class="p">)</span><span class="w"> </span><span class="n">solve_line</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">read_stat</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">EXIT</span>
<span class="k">               write</span><span class="p">(</span><span class="n">dbgUnit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">solve_line</span><span class="p">)</span>
<span class="w">              </span><span class="k">write</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">solSpec_unit</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">solve_line</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">          end if</span><span class="w"> </span><span class="c">!unitOpened</span>
<span class="w">        </span><span class="k">end if</span><span class="w">  </span><span class="c">!solSpecUnit&gt;0</span>
<span class="w">      </span><span class="k">end if</span><span class="w"> </span><span class="c">!present solSpecUnit</span>
<span class="w">    </span><span class="k">end if</span><span class="w"> </span><span class="c">!root process and active writeRestart</span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">tem_init_restart</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Treelm
 was developed by University of Siegen<br>              &copy; 2025 
<br /><small>9899d1376992</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-02T13:06:23.655310+0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>